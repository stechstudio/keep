import{c as e,a as t,o as l,b as a,d as s,e as r,f as o,t as n,n as u,g as i,w as d,F as c,h as v,u as p,T as m,r as g,i as f,j as y,k as b,l as x,m as h,p as k,q as w,v as C,s as S,x as $,y as j,z as M,A as V,B as T,C as _,D as L,E as B,G as z,H as E}from"./vendor.Bd_G0U2D.js";import{u as K,m as D,f as A}from"./utils.BRZPlJQG.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const l of e)if("childList"===l.type)for(const e of l.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const U={class:"flex items-start space-x-3"},O={key:0,class:"flex-shrink-0 mt-0.5"},P={class:"flex-1"},I={key:0,class:"font-semibold text-sm"},q={key:1,class:"text-sm mt-1 opacity-90"},F={__name:"Toast",props:{toast:{type:Object,required:!0}},emits:["dismiss"],setup(i){const d=i,c=e(()=>{const e={default:"bg-card border-border text-card-foreground",success:"bg-green-950 border-green-900 text-green-100",destructive:"bg-red-950 border-red-900 text-red-100"};return e[d.toast.variant]||e.default}),v=e(()=>"success"===d.toast.variant?{template:'\n        <svg class="text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />\n        </svg>\n      '}:"destructive"===d.toast.variant?{template:'\n        <svg class="text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />\n        </svg>\n      '}:null);return(e,d)=>(l(),t("div",{class:u(["pointer-events-auto relative flex w-full items-center justify-between rounded-lg border p-4 shadow-lg transition-all",c.value])},[a("div",U,[v.value?(l(),t("div",O,[(l(),r(o(v.value),{class:"h-5 w-5"}))])):s("",!0),a("div",P,[i.toast.title?(l(),t("div",I,n(i.toast.title),1)):s("",!0),i.toast.description?(l(),t("div",q,n(i.toast.description),1)):s("",!0)])]),a("button",{onClick:d[0]||(d[0]=t=>e.$emit("dismiss",i.toast.id)),class:"flex-shrink-0 ml-4 inline-flex rounded-md p-1.5 focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors hover:bg-accent"},[...d[1]||(d[1]=[a("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])],2))}},N=(e,t)=>{const l=e.__vccOpts||e;for(const[a,s]of t)l[a]=s;return l},R={class:"fixed bottom-0 right-0 z-50 p-4 space-y-4 max-w-md w-full pointer-events-none"},H=N({__name:"ToastContainer",setup(e){const{toasts:a,dismiss:s}=K();return(e,o)=>(l(),t("div",R,[i(m,{name:"toast",tag:"div"},{default:d(()=>[(l(!0),t(c,null,v(p(a),e=>(l(),r(F,{key:e.id,toast:e,onDismiss:p(s)},null,8,["toast","onDismiss"]))),128))]),_:1})]))}},[["__scopeId","data-v-ac8f77a9"]]),J=g({search:null,closeModal:[],toggleMask:null});function G(){function e(e){"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&"SELECT"!==e.target.tagName?("/"!==e.key||e.metaKey||e.ctrlKey||(e.preventDefault(),J.value.search&&J.value.search()),"Escape"===e.key&&(e.preventDefault(),J.value.closeModal.forEach(e=>e())),"m"!==e.key||e.metaKey||e.ctrlKey||(e.preventDefault(),J.value.toggleMask&&J.value.toggleMask())):"Escape"===e.key&&(e.preventDefault(),J.value.closeModal.forEach(e=>e()))}let t=!1;return{registerSearchHandler:function(e){J.value.search=e},registerModalCloseHandler:function(e){return J.value.closeModal.push(e),()=>{const t=J.value.closeModal.indexOf(e);t>-1&&J.value.closeModal.splice(t,1)}},registerMaskToggleHandler:function(e){J.value.toggleMask=e},setupGlobalListener:function(){t||(document.addEventListener("keydown",e),t=!0)},teardownGlobalListener:function(){t&&(document.removeEventListener("keydown",e),t=!1)}}}const Y={class:"min-h-screen bg-background text-foreground"},W={class:"border-b border-border"},X={class:"max-w-full px-4 sm:px-6 lg:px-8"},Z={class:"flex items-center justify-between h-16"},Q={class:"flex items-center w-1/3"},ee={class:"text-xl font-semibold opacity-75"},te={class:"flex items-center space-x-2 bg-muted rounded-full p-1"},le=["onClick"],ae={class:"w-1/3 text-right"},se={href:"https://github.com/stechstudio/keep",target:"_blank",class:"text-white/50 hover:text-white"},re={class:"max-w-full px-4 sm:px-6 lg:px-8 py-6"},oe={__name:"App",setup(e){const s=[{id:"secrets",label:"Secrets",path:"/secrets"},{id:"templates",label:"Templates",path:"/templates"},{id:"diff",label:"Compare",path:"/diff"},{id:"settings",label:"Settings",path:"/settings"}],r=g("Keep"),o=g(""),{setupGlobalListener:p,teardownGlobalListener:m}=G();return f(async()=>{p(),await async function(){try{const e=await window.$api.getSettings();r.value=e.app_name||"Keep",o.value=e.keep_version||""}catch(e){}}()}),y(()=>{m()}),(e,p)=>{const m=b("router-link"),g=b("router-view");return l(),t("div",Y,[i(H),a("nav",W,[a("div",X,[a("div",Z,[a("div",Q,[p[0]||(p[0]=a("div",{class:"size-9 pl-3 pr-2 rounded bg-muted mr-3 flex items-center justify-center text-primary"},[a("svg",{fill:"none",height:"100%",viewBox:"0 0 59 70",width:"59",xmlns:"http://www.w3.org/2000/svg"},[a("path",{d:"m58.4476 69.14c-10.35 0-23.67-12.33-31.41-22.05-5.13-6.39-7.11-8.91-9.45-11.7l-4.32 4.32v25.29h-12.599982v-64.620005h12.599982v32.580005l31.5-32.580005h7.2l-24.21 24.570005z",fill:"currentColor"})])],-1)),a("span",ee,n(r.value)+" Secrets",1)]),a("div",te,[(l(),t(c,null,v(s,t=>i(m,{key:t.id,to:t.path,custom:""},{default:d(({isActive:l})=>[a("button",{onClick:l=>e.$router.push(t.path),class:u(["px-4 py-1.5 rounded-full text-sm font-medium transition-colors",l?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"])},n(t.label),11,le)]),_:2},1032,["to"])),64))]),a("div",ae,[a("a",se,"Keep v"+n(o.value),1)])])])]),a("main",re,[i(g)])])}}},ne={class:"flex items-center space-x-3"},ue={class:"relative"},ie={key:0,class:"absolute top-full mt-1 bg-popover border border-border rounded-md shadow-lg z-10"},de={class:"py-1"},ce=["onClick"],ve={class:"relative"},pe={key:0,class:"absolute top-full mt-1 w-48 bg-popover border border-border rounded-md shadow-lg z-10"},me={class:"py-1"},ge=["onClick"],fe={__name:"VaultStageSelector",props:{vault:String,stage:String,vaults:Array,stages:Array},emits:["update:vault","update:stage"],setup(r,{emit:o}){const i=r,d=o,p=g(!1),m=g(!1),f=e(()=>{var e;if(!i.vault)return"";const t=null==(e=i.vaults)?void 0:e.find(e=>("object"==typeof e?e.slug||e.name:e)===i.vault);return(null==t?void 0:t.display)||i.vault});return document.addEventListener("click",e=>{e.target.closest(".relative")||(p.value=!1,m.value=!1)}),(e,o)=>(l(),t("div",ne,[a("div",ue,[a("button",{onClick:o[0]||(o[0]=e=>p.value=!p.value),class:"flex items-center space-x-2 px-3 pl-0 py-1.5 transition-colors"},[a("span",null,n(f.value||"Select Vault"),1),o[2]||(o[2]=a("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))]),p.value?(l(),t("div",ie,[a("div",de,[(l(!0),t(c,null,v(r.vaults,e=>(l(),t("button",{key:e.slug||e.name||e,onClick:t=>function(e){d("update:vault",e),p.value=!1}(e.slug||e.name||e),class:u(["w-full text-left px-3 py-2 text-sm hover:bg-accent transition-colors whitespace-nowrap",r.vault===(e.slug||e.name||e)?"bg-white/10":""])},n(e.display||e),11,ce))),128))])])):s("",!0)]),o[4]||(o[4]=a("div",{class:"text-lg text-white/30 font-bold pr-3"},"/",-1)),a("div",ve,[a("button",{onClick:o[1]||(o[1]=e=>m.value=!m.value),class:"flex items-center space-x-2 px-3 pl-0 py-1.5 transition-colors"},[a("span",null,n(r.stage||"Select Stage"),1),o[3]||(o[3]=a("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))]),m.value?(l(),t("div",pe,[a("div",me,[(l(!0),t(c,null,v(r.stages,e=>(l(),t("button",{key:e,onClick:t=>function(e){d("update:stage",e),m.value=!1}(e),class:u(["w-full text-left px-3 py-2 text-sm hover:bg-accent transition-colors",r.stage===e?"bg-white/10":""])},n(e),11,ge))),128))])])):s("",!0)])]))}},ye={class:"flex items-center space-x-2"},be={class:"font-mono text-sm"},xe=["title"],he={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ke={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},we={__name:"SecretValue",props:{value:String,masked:{type:Boolean,default:!0}},emits:["toggle"],setup(s){const r=s,o=e(()=>r.masked?D(r.value):r.value);return(e,r)=>(l(),t("div",ye,[a("span",be,n(o.value),1),a("button",{onClick:r[0]||(r[0]=t=>e.$emit("toggle")),class:"p-1 rounded hover:bg-muted transition-colors",title:s.masked?"Show value":"Hide value"},[s.masked?(l(),t("svg",he,[...r[1]||(r[1]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])])):(l(),t("svg",ke,[...r[2]||(r[2]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])]))],8,xe)]))}};const Ce=new class{constructor(){this.baseUrl="",this.token=window.KEEP_AUTH_TOKEN}async request(e,t={}){const l=await fetch(`${this.baseUrl}/api${e}`,{...t,headers:{"X-Auth-Token":this.token,"Content-Type":"application/json",...t.headers}});if(!l.ok){const e=await l.json().catch(()=>({error:"Request failed"}));throw new Error(e.error||`HTTP ${l.status}`)}return l.json()}async listSecrets(e,t,l=!1){return this.request(`/secrets?vault=${e}&stage=${t}&unmask=${l}`)}async getSecret(e,t,l,a=!1){return this.request(`/secrets/${encodeURIComponent(e)}?vault=${t}&stage=${l}&unmask=${a}`)}async createSecret(e,t,l,a){return this.request("/secrets",{method:"POST",body:JSON.stringify({key:e,value:t,vault:l,stage:a})})}async updateSecret(e,t,l,a){return this.request(`/secrets/${encodeURIComponent(e)}`,{method:"PUT",body:JSON.stringify({value:t,vault:l,stage:a})})}async deleteSecret(e,t,l){return this.request(`/secrets/${encodeURIComponent(e)}`,{method:"DELETE",body:JSON.stringify({vault:t,stage:l})})}async renameSecret(e,t,l,a){return this.request(`/secrets/${encodeURIComponent(e)}/rename`,{method:"POST",body:JSON.stringify({newKey:t,vault:l,stage:a})})}async copySecretToStage(e,t,l,a,s){return this.request(`/secrets/${encodeURIComponent(e)}/copy-to-stage?vault=${s}&stage=${a}`,{method:"POST",body:JSON.stringify({targetStage:t,targetVault:l})})}async searchSecrets(e,t,l,a=!1){return this.request(`/search?q=${encodeURIComponent(e)}&vault=${t}&stage=${l}&unmask=${a}`)}async getSecretHistory(e,t,l,a=10,s=!1){return this.request(`/secrets/${encodeURIComponent(e)}/history?vault=${t}&stage=${l}&limit=${a}&unmask=${s}`)}async getSettings(){return this.request("/settings")}async updateSettings(e){return this.request("/settings",{method:"PUT",body:JSON.stringify(e)})}async listVaults(){return this.request("/vaults")}async addVault(e){return this.request("/vaults",{method:"POST",body:JSON.stringify(e)})}async updateVault(e,t){return this.request(`/vaults/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteVault(e){return this.request(`/vaults/${e}`,{method:"DELETE"})}async listStages(){return this.request("/stages")}async addStage(e){return this.request("/stages",{method:"POST",body:JSON.stringify({stage:e})})}async removeStage(e){return this.request("/stages",{method:"DELETE",body:JSON.stringify({stage:e})})}async verifyVaults(){return this.request("/verify",{method:"POST"})}async getDiff(e=null,t=null){let l="/diff?";return e&&(l+=`stages=${e.join(",")}&`),t&&(l+=`vaults=${t.join(",")}`),this.request(l)}async exportSecrets(e,t,l="env"){return this.request("/export",{method:"POST",body:JSON.stringify({vault:e,stage:t,format:l})})}async analyzeImport({content:e,vault:t,stage:l,only:a=null,except:s=null}){return this.request("/import/analyze",{method:"POST",body:JSON.stringify({content:e,vault:t,stage:l,only:a,except:s})})}async executeImport({content:e,vault:t,stage:l,strategy:a,only:s=null,except:r=null,dry_run:o=!1}){return this.request("/import/execute",{method:"POST",body:JSON.stringify({content:e,vault:t,stage:l,strategy:a,only:s,except:r,dry_run:o})})}};function Se(){const e=g([]),t=g(!1),l=g(null);return{secrets:e,loading:t,error:l,loadSecrets:async function(a,s,r=!1){t.value=!0,l.value=null;try{const t=await Ce.listSecrets(a,s,r);return e.value=t.secrets,e.value}catch(o){throw l.value=o.message,e.value=[],o}finally{t.value=!1}},createSecret:async function(e,a,s,r){t.value=!0,l.value=null;try{return await Ce.createSecret(e,a,s,r)}catch(o){throw l.value=o.message,o}finally{t.value=!1}},updateSecret:async function(e,a,s,r){t.value=!0,l.value=null;try{return await Ce.updateSecret(e,a,s,r)}catch(o){throw l.value=o.message,o}finally{t.value=!1}},deleteSecret:async function(e,a,s){t.value=!0,l.value=null;try{return await Ce.deleteSecret(e,a,s)}catch(r){throw l.value=r.message,r}finally{t.value=!1}},renameSecret:async function(e,a,s,r){t.value=!0,l.value=null;try{return await Ce.renameSecret(e,a,s,r)}catch(o){throw l.value=o.message,o}finally{t.value=!1}},copySecretToStage:async function(e,a,s,r,o){t.value=!0,l.value=null;try{return await Ce.copySecretToStage(e,a,s,r,o)}catch(n){throw l.value=n.message,n}finally{t.value=!1}},searchSecrets:async function(a,s,r,o=!1){t.value=!0,l.value=null;try{const t=await Ce.searchSecrets(a,s,r,o);return e.value=t.secrets,e.value}catch(n){throw l.value=n.message,e.value=[],n}finally{t.value=!1}},getSecretHistory:async function(e,a,s,r=10,o=!1){t.value=!0,l.value=null;try{return await Ce.getSecretHistory(e,a,s,r,o)}catch(n){throw l.value=n.message,n}finally{t.value=!1}},clearError:function(){l.value=null}}}const $e={class:"bg-card border border-border rounded-lg p-6 w-full max-w-md"},je={class:"text-lg font-semibold mb-4"},Me={class:"space-y-4"},Ve=["disabled"],Te={key:0,class:"mt-1 text-xs text-red-500"},_e={class:"text-xs text-muted-foreground"},Le={class:"font-medium"},Be={class:"font-medium"},ze={key:0,class:"p-3 bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-900 rounded-md"},Ee={class:"text-sm text-red-600 dark:text-red-400"},Ke={class:"flex justify-end space-x-3 mt-6"},De=["disabled"],Ae={__name:"SecretDialog",props:{secret:Object,vault:String,stage:String,initialKey:String},emits:["success","close"],setup(r,{emit:o}){const i=r,d=o,c=K(),{createSecret:v,updateSecret:p}=Se(),m=x({key:"",value:""}),f=g(""),y=g(""),b=g(!1),$=e(()=>m.key?m.key.includes(" ")?(f.value="No spaces allowed",!1):/^[A-Za-z0-9_\-/.]+$/.test(m.key)?(f.value="",!0):(f.value="Only letters, numbers, _, -, /, . allowed",!1):(f.value="",!0));async function j(){if($.value&&!b.value){y.value="",b.value=!0;try{i.secret?(await p(m.key,m.value,i.vault,i.stage),c.success("Secret updated",`Secret '${m.key}' has been updated successfully`)):(await v(m.key,m.value,i.vault,i.stage),c.success("Secret created",`Secret '${m.key}' has been created successfully`)),d("success"),d("close")}catch(e){y.value=e.message||"Failed to save secret"}finally{b.value=!1}}}return h(()=>i.secret,e=>{e?(m.key=e.key,m.value=e.value):(m.key=i.initialKey||"",m.value="")},{immediate:!0}),h(()=>i.initialKey,e=>{!i.secret&&e&&(m.key=e)},{immediate:!0}),h(()=>m.key,()=>{$.value}),(e,o)=>(l(),t("div",{class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:o[3]||(o[3]=k(t=>e.$emit("close"),["self"]))},[a("div",$e,[a("h2",je,n(r.secret?"Edit Secret":"Add Secret"),1),a("form",{onSubmit:k(j,["prevent"])},[a("div",Me,[a("div",null,[o[4]||(o[4]=a("label",{class:"block text-sm font-medium mb-1"},"Key",-1)),w(a("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>m.key=e),type:"text",disabled:!!r.secret,class:u(["w-full px-3 py-2 bg-input border rounded-md text-sm focus:outline-none focus:ring-2 disabled:opacity-50 disabled:cursor-not-allowed",f.value?"border-red-500 focus:ring-red-500":"border-border focus:ring-ring"]),placeholder:"SECRET_KEY",required:""},null,10,Ve),[[C,m.key]]),f.value?(l(),t("p",Te,n(f.value),1)):s("",!0)]),a("div",null,[o[5]||(o[5]=a("label",{class:"block text-sm font-medium mb-1"},"Value",-1)),w(a("textarea",{"onUpdate:modelValue":o[1]||(o[1]=e=>m.value=e),rows:"4",class:"w-full px-3 py-2 bg-input border border-border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring font-mono",placeholder:"Secret value...",required:""},null,512),[[C,m.value]])]),a("div",_e,[o[6]||(o[6]=S(" Vault: ",-1)),a("span",Le,n(r.vault),1),o[7]||(o[7]=S(" • Stage: ",-1)),a("span",Be,n(r.stage),1)]),y.value?(l(),t("div",ze,[a("p",Ee,n(y.value),1)])):s("",!0)]),a("div",Ke,[a("button",{type:"button",onClick:o[2]||(o[2]=t=>e.$emit("close")),class:"px-4 py-2 text-sm font-medium border border-border rounded-md hover:bg-muted transition-colors"}," Cancel "),a("button",{type:"submit",disabled:!$.value||b.value,class:"px-4 py-2 text-sm font-medium bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},n(b.value?"Saving...":r.secret?"Save":"Add"),9,De)])],32)])]))}},Ue={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Oe={class:"bg-card border border-border rounded-lg p-6 w-96 max-w-full"},Pe={class:"mb-4"},Ie=["value"],qe={class:"mb-6"},Fe={key:0,class:"mt-1 text-xs text-red-500"},Ne={key:1,class:"mt-2 text-sm text-red-500"},Re={class:"flex justify-end space-x-3"},He=["disabled"],Je={__name:"RenameDialog",props:{currentKey:{type:String,required:!0},vault:{type:String,required:!0},stage:{type:String,required:!0}},emits:["close","success"],setup(r,{emit:o}){const i=r,d=o,c=K(),{renameSecret:v}=Se(),p=g(i.currentKey),m=g(""),f=g(""),y=g(!1),b=e(()=>{const e=p.value.trim();return e?e===i.currentKey?(m.value="",!1):e.includes(" ")?(m.value="No spaces allowed",!1):/^[A-Za-z0-9_\-/.]+$/.test(e)?(m.value="",!0):(m.value="Only letters, numbers, _, -, /, . allowed",!1):(m.value="",!1)}),x=e(()=>b.value);async function k(){if(x.value&&!y.value){f.value="",y.value=!0;try{await v(i.currentKey,p.value.trim(),i.vault,i.stage),c.success("Secret renamed",`Secret renamed from '${i.currentKey}' to '${p.value.trim()}'`),d("success"),d("close")}catch(e){f.value=e.message||"Failed to rename secret"}finally{y.value=!1}}}return h(()=>p.value,()=>{b.value}),(e,o)=>(l(),t("div",Ue,[a("div",Oe,[o[4]||(o[4]=a("h2",{class:"text-lg font-semibold mb-4"},"Rename Secret",-1)),a("div",Pe,[o[2]||(o[2]=a("label",{class:"block text-sm font-medium mb-2"},"Current Key",-1)),a("input",{value:r.currentKey,disabled:"",class:"w-full px-3 py-2 bg-muted border border-border rounded-md text-sm opacity-60"},null,8,Ie)]),a("div",qe,[o[3]||(o[3]=a("label",{class:"block text-sm font-medium mb-2"},"New Key",-1)),w(a("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>p.value=e),onKeyup:$(k,["enter"]),type:"text",placeholder:"Enter new key name",class:u(["w-full px-3 py-2 bg-input border rounded-md text-sm focus:outline-none focus:ring-2",m.value||f.value?"border-red-500 focus:ring-red-500":"border-border focus:ring-ring"])},null,34),[[C,p.value]]),m.value?(l(),t("p",Fe,n(m.value),1)):s("",!0),f.value&&!m.value?(l(),t("p",Ne,n(f.value),1)):s("",!0)]),a("div",Re,[a("button",{onClick:o[1]||(o[1]=t=>e.$emit("close")),class:"px-4 py-2 text-sm border border-border rounded-md hover:bg-accent transition-colors"}," Cancel "),a("button",{onClick:k,disabled:!x.value||y.value,class:"px-4 py-2 text-sm bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},n(y.value?"Renaming...":"Rename"),9,He)])])]))}},Ge={class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ye={class:"bg-card border border-border rounded-lg p-6 w-96 max-w-full"},We={class:"mb-4"},Xe=["value"],Ze={class:"mb-4"},Qe=["value"],et={class:"mb-6"},tt=["value","disabled"],lt={class:"flex justify-end space-x-3"},at=["disabled"],st={__name:"CopyToStageDialog",props:{secretKey:{type:String,required:!0},currentVault:{type:String,required:!0},currentStage:{type:String,required:!0},vaults:{type:Array,required:!0},stages:{type:Array,required:!0}},emits:["close","copy"],setup(s,{emit:r}){const o=s,u=r,i=g(""),d=e(()=>{const e=[];for(const t of o.vaults)for(const l of o.stages)e.push({key:`${t.slug||t}:${l}`,vaultSlug:t.slug||t,display:t.display||t.name||t,stage:l});return e});function p(){if(i.value){const[e,t]=i.value.split(":");u("copy",{targetVault:e,targetStage:t})}}return(e,r)=>(l(),t("div",Ge,[a("div",Ye,[r[6]||(r[6]=a("h2",{class:"text-lg font-semibold mb-4"},"Copy Secret",-1)),a("div",We,[r[2]||(r[2]=a("label",{class:"block text-sm font-medium mb-2"},"Secret Key",-1)),a("input",{value:s.secretKey,disabled:"",class:"w-full px-3 py-2 bg-muted border border-border rounded-md text-sm opacity-60"},null,8,Xe)]),a("div",Ze,[r[3]||(r[3]=a("label",{class:"block text-sm font-medium mb-2"},"From",-1)),a("input",{value:`${s.currentVault} / ${s.currentStage}`,disabled:"",class:"w-full px-3 py-2 bg-muted border border-border rounded-md text-sm opacity-60"},null,8,Qe)]),a("div",et,[r[5]||(r[5]=a("label",{class:"block text-sm font-medium mb-2"},"Copy To",-1)),w(a("select",{"onUpdate:modelValue":r[0]||(r[0]=e=>i.value=e),class:"w-full px-3 py-2 bg-input border border-border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring"},[r[4]||(r[4]=a("option",{value:""},"Select destination...",-1)),(l(!0),t(c,null,v(d.value,e=>(l(),t("option",{key:e.key,value:e.key,disabled:e.key===`${s.currentVault}:${s.currentStage}`},n(e.display)+" / "+n(e.stage),9,tt))),128))],512),[[j,i.value]])]),a("div",lt,[a("button",{onClick:r[1]||(r[1]=t=>e.$emit("close")),class:"px-4 py-2 text-sm border border-border rounded-md hover:bg-accent transition-colors"}," Cancel "),a("button",{onClick:p,disabled:!i.value,class:"px-4 py-2 text-sm bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," Copy Secret ",8,at)])])]))}},rt={class:"bg-card border border-border rounded-lg p-6 w-full max-w-4xl max-h-[80vh] flex flex-col"},ot={class:"flex items-center justify-between mb-4"},nt={class:"text-sm text-muted-foreground mt-1"},ut={key:0,class:"flex-1 flex items-center justify-center"},it={key:1,class:"flex-1 flex items-center justify-center"},dt={class:"text-destructive"},ct={key:2,class:"flex-1 flex items-center justify-center"},vt={key:3,class:"flex-1 overflow-y-auto"},pt={class:"w-full"},mt={class:"sticky top-0 bg-card border-b border-border"},gt={class:"text-left px-4 py-2 text-xs font-medium text-muted-foreground uppercase tracking-wider"},ft={class:"flex items-center space-x-2"},yt=["title"],bt={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},xt={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ht={class:"divide-y divide-border"},kt={class:"px-4 py-3 text-sm"},wt={class:"px-4 py-3 text-sm"},Ct={class:"font-mono"},St={class:"px-4 py-3 text-sm text-muted-foreground"},$t={class:"px-4 py-3"},jt={class:"text-sm"},Mt={class:"text-xs text-muted-foreground/70"},Vt={class:"flex justify-between items-center mt-4 pt-4 border-t border-border"},Tt={class:"text-sm text-muted-foreground"},_t={__name:"HistoryDialog",props:{secretKey:{type:String,required:!0},vault:{type:String,required:!0},stage:{type:String,required:!0}},emits:["close","refresh"],setup(e,{emit:s}){const r=e,{getSecretHistory:o}=Se(),i=g([]),d=g(!0),m=g(null),y=g(!1);function b(){y.value=!y.value}return f(()=>{!async function(){d.value=!0,m.value=null;try{const e=await o(r.secretKey,r.vault,r.stage,20,!0);i.value=e.history||[]}catch(e){m.value=e.message||"Failed to load history"}finally{d.value=!1}}()}),(s,r)=>(l(),t("div",{class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:r[2]||(r[2]=k(e=>s.$emit("close"),["self"]))},[a("div",rt,[a("div",ot,[a("div",null,[r[3]||(r[3]=a("h2",{class:"text-lg font-semibold"},"Secret History",-1)),a("p",nt,n(e.secretKey)+" • "+n(e.vault)+" / "+n(e.stage),1)]),a("button",{onClick:r[0]||(r[0]=e=>s.$emit("close")),class:"p-1 rounded-md hover:bg-muted transition-colors"},[...r[4]||(r[4]=[a("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),d.value?(l(),t("div",ut,[...r[5]||(r[5]=[a("div",{class:"text-muted-foreground"},"Loading history...",-1)])])):m.value?(l(),t("div",it,[a("div",dt,n(m.value),1)])):0===i.value.length?(l(),t("div",ct,[...r[6]||(r[6]=[a("div",{class:"text-muted-foreground"},"No history found for this secret",-1)])])):(l(),t("div",vt,[a("table",pt,[a("thead",mt,[a("tr",null,[r[10]||(r[10]=a("th",{class:"text-left px-4 py-2 text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Version",-1)),a("th",gt,[a("div",ft,[r[9]||(r[9]=a("span",null,"Value",-1)),a("button",{onClick:b,class:"p-1 rounded hover:bg-accent transition-colors",title:y.value?"Hide values":"Show values"},[y.value?(l(),t("svg",xt,[...r[8]||(r[8]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])])):(l(),t("svg",bt,[...r[7]||(r[7]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])]))],8,yt)])]),r[11]||(r[11]=a("th",{class:"text-left px-4 py-2 text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Type",-1)),r[12]||(r[12]=a("th",{class:"text-left px-4 py-2 text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Modified",-1))])]),a("tbody",ht,[(l(!0),t(c,null,v(i.value,(e,s)=>{return l(),t("tr",{key:`${e.version}-${s}`,class:"hover:bg-muted/50 transition-colors"},[a("td",kt,[a("span",{class:u(["inline-flex items-center px-2 py-1 rounded-md text-xs font-medium",0===s?"bg-primary/10 text-primary":"bg-accent"])}," v"+n(e.version),3)]),a("td",wt,[a("span",Ct,n((r=e.value,r?y.value?r:D(r):"(null)")),1)]),a("td",St,n(e.dataType),1),a("td",$t,[a("div",jt,n(p(A)(e.timestamp||e.modifiedDate)),1),a("div",Mt,n(e.modifiedBy),1)])]);var r}),128))])])])),a("div",Vt,[a("div",Tt," Showing "+n(i.value.length)+" revision"+n(1===i.value.length?"":"s"),1),a("button",{onClick:r[1]||(r[1]=e=>s.$emit("close")),class:"px-4 py-2 text-sm font-medium border border-border rounded-md hover:bg-muted transition-colors"}," Close ")])])]))}},Lt={class:"bg-card border border-border rounded-lg p-6 w-full max-w-md"},Bt={class:"flex items-start space-x-3"},zt={class:"flex-1"},Et={class:"mt-3 p-3 bg-muted/50 rounded-md"},Kt={class:"text-sm"},Dt={class:"font-medium"},At={class:"text-xs text-muted-foreground mt-1"},Ut={key:0,class:"mt-3 p-3 bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-900 rounded-md"},Ot={class:"text-sm text-red-600 dark:text-red-400"},Pt={class:"flex justify-end space-x-3 mt-6"},It=["disabled"],qt={__name:"DeleteConfirmDialog",props:{secretKey:{type:String,required:!0},vault:{type:String,required:!0},stage:{type:String,required:!0}},emits:["close","success"],setup(e,{emit:r}){const o=e,u=r,i=K(),{deleteSecret:d}=Se(),c=g(""),v=g(!1);async function p(){if(!v.value){c.value="",v.value=!0;try{await d(o.secretKey,o.vault,o.stage),i.success("Secret deleted",`Secret '${o.secretKey}' has been deleted successfully`),u("success"),u("close")}catch(e){c.value=e.message||"Failed to delete secret"}finally{v.value=!1}}}return(r,o)=>(l(),t("div",{class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:o[1]||(o[1]=k(e=>r.$emit("close"),["self"]))},[a("div",Lt,[a("div",Bt,[o[5]||(o[5]=a("div",{class:"flex-shrink-0"},[a("div",{class:"h-10 w-10 rounded-full bg-destructive/10 flex items-center justify-center"},[a("svg",{class:"h-6 w-6 text-destructive",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])])],-1)),a("div",zt,[o[2]||(o[2]=a("h3",{class:"text-lg font-semibold"},"Delete Secret",-1)),o[3]||(o[3]=a("p",{class:"mt-2 text-sm text-muted-foreground"}," Are you sure you want to delete this secret? ",-1)),a("div",Et,[a("div",Kt,[a("div",Dt,n(e.secretKey),1),a("div",At,n(e.vault)+" / "+n(e.stage),1)])]),o[4]||(o[4]=a("p",{class:"mt-3 text-sm text-muted-foreground"}," This action cannot be undone. ",-1)),c.value?(l(),t("div",Ut,[a("p",Ot,n(c.value),1)])):s("",!0)])]),a("div",Pt,[a("button",{onClick:o[0]||(o[0]=e=>r.$emit("close")),class:"px-4 py-2 text-sm font-medium border border-border rounded-md hover:bg-muted transition-colors"}," Cancel "),a("button",{onClick:p,disabled:v.value,class:"px-4 py-2 text-sm font-medium bg-destructive text-destructive-foreground rounded-md hover:bg-destructive/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},n(v.value?"Deleting...":"Delete Secret"),9,It)])])]))}},Ft={class:"relative inline-block text-left"},Nt={class:"py-1 flex flex-col"},Rt={__name:"SecretActionsMenu",props:{secretKey:{type:String,required:!0},secretValue:{type:String,default:null},vault:{type:String,required:!0},stage:{type:String,required:!0},showEdit:{type:Boolean,default:!0},showRename:{type:Boolean,default:!0},showCreate:{type:Boolean,default:!1},showCopyValue:{type:Boolean,default:!0},showCopyTo:{type:Boolean,default:!0},showDelete:{type:Boolean,default:!0},showHistory:{type:Boolean,default:!0},buttonClass:{type:String,default:""}},emits:["edit","rename","create","copyValue","copyTo","delete","history","refresh"],setup(e,{emit:o}){const n=e,i=o,d=g(!1),c=g({}),v=g(null);function p(e){if(e.stopPropagation(),d.value)d.value=!1;else{document.dispatchEvent(new CustomEvent("close-all-menus"));const t=e.currentTarget.getBoundingClientRect(),l=192,a=40*[n.showEdit,n.showRename,n.showCreate,n.showCopyValue,n.showCopyTo,n.showHistory,n.showDelete].filter(Boolean).length+8;let s=t.right-l,r=t.bottom+4+window.scrollY;t.bottom+a>window.innerHeight&&t.top>a&&(r=t.top-a+16+window.scrollY),s<0&&(s=t.left),c.value={left:`${s}px`,top:`${r}px`},setTimeout(()=>{d.value=!0},0)}}function m(){i("edit",{key:n.secretKey,value:n.secretValue,vault:n.vault,stage:n.stage}),d.value=!1}function b(){i("rename",{key:n.secretKey,value:n.secretValue,vault:n.vault,stage:n.stage}),d.value=!1}function x(){i("create",{key:n.secretKey,vault:n.vault,stage:n.stage}),d.value=!1}function h(){n.secretValue&&navigator.clipboard.writeText(n.secretValue),i("copyValue",{key:n.secretKey,vault:n.vault,stage:n.stage}),d.value=!1}function k(){i("copyTo",{key:n.secretKey,value:n.secretValue,vault:n.vault,stage:n.stage}),d.value=!1}function w(){i("history",{key:n.secretKey,vault:n.vault,stage:n.stage}),d.value=!1}function C(){i("delete",{key:n.secretKey,vault:n.vault,stage:n.stage}),d.value=!1}function S(e){d.value&&v.value&&!v.value.contains(e.target)&&(d.value=!1)}function $(){d.value=!1}function j(){d.value&&(d.value=!1)}return f(()=>{document.addEventListener("click",S),document.addEventListener("close-all-menus",$),window.addEventListener("scroll",j,!0)}),y(()=>{document.removeEventListener("click",S),document.removeEventListener("close-all-menus",$),window.removeEventListener("scroll",j,!0)}),(o,n)=>(l(),t("div",Ft,[a("button",{ref_key:"buttonRef",ref:v,onClick:p,class:u(["p-1 rounded hover:bg-muted transition-colors",e.buttonClass])},[...n[0]||(n[0]=[a("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[a("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})],-1)])],2),d.value?(l(),r(V,{key:0,to:"body"},[a("div",{style:M(c.value),class:"absolute w-48 bg-popover border border-border rounded-md shadow-lg z-50"},[a("div",Nt,[e.showEdit?(l(),t("button",{key:0,onClick:m,class:"w-full text-left px-4 py-2 text-sm hover:bg-accent transition-colors"}," Edit ")):s("",!0),e.showRename?(l(),t("button",{key:1,onClick:b,class:"w-full text-left px-4 py-2 text-sm hover:bg-accent transition-colors"}," Rename ")):s("",!0),e.showCreate?(l(),t("button",{key:2,onClick:x,class:"w-full text-left px-4 py-2 text-sm hover:bg-accent transition-colors"}," Create ")):s("",!0),e.showCopyValue?(l(),t("button",{key:3,onClick:h,class:"w-full text-left px-4 py-2 text-sm hover:bg-accent transition-colors"}," Copy Value ")):s("",!0),e.showCopyTo?(l(),t("button",{key:4,onClick:k,class:"w-full text-left px-4 py-2 text-sm hover:bg-accent transition-colors"}," Copy To... ")):s("",!0),e.showHistory?(l(),t("button",{key:5,onClick:w,class:"w-full text-left px-4 py-2 text-sm hover:bg-accent transition-colors"}," History ")):s("",!0),e.showDelete?(l(),t("button",{key:6,onClick:C,class:"w-full text-left px-4 py-2 text-sm text-destructive hover:bg-accent transition-colors"}," Delete ")):s("",!0)])],4)])):s("",!0)]))}},Ht={class:"bg-card border border-border rounded-lg w-full max-w-3xl max-h-[80vh] overflow-hidden flex flex-col"},Jt={class:"flex-1 overflow-y-auto px-6 py-4"},Gt={key:0,class:"space-y-4"},Yt={class:"text-sm font-medium mb-2"},Wt={class:"text-sm text-muted-foreground mt-3"},Xt={class:"space-y-3 pt-4 border-t border-border"},Zt={class:"grid grid-cols-2 gap-4"},Qt={key:1,class:"space-y-4"},el={class:"flex items-center space-x-6 text-sm"},tl={class:"font-medium text-green-500"},ll={class:"font-medium text-yellow-500"},al={class:"font-medium text-red-500"},sl={class:"font-medium text-gray-500"},rl={key:0,class:"border border-yellow-500/20 bg-yellow-500/5 rounded-lg p-4"},ol={class:"space-y-2"},nl={class:"flex items-center space-x-2"},ul={class:"flex items-center space-x-2"},il={class:"border border-border rounded-lg overflow-hidden"},dl={class:"w-full text-sm"},cl={class:"divide-y divide-border"},vl={class:"px-4 py-2 font-mono"},pl={class:"px-4 py-2 font-mono text-xs"},ml={class:"px-4 py-2"},gl={key:0,class:"block text-xs text-red-500 mt-1"},fl={class:"flex items-center space-x-2"},yl={key:2,class:"space-y-4"},bl={class:"font-medium mb-2"},xl={class:"flex items-center space-x-6 text-sm"},hl={class:"font-medium text-green-500"},kl={class:"font-medium text-yellow-500"},wl={class:"font-medium text-red-500"},Cl={key:0,class:"border border-blue-500/20 bg-blue-500/5 rounded-lg p-4"},Sl={key:1,class:"border border-red-500/20 bg-red-500/5 rounded-lg p-4"},$l={class:"list-disc list-inside space-y-1"},jl={class:"border border-border rounded-lg overflow-hidden"},Ml={class:"w-full text-sm"},Vl={class:"divide-y divide-border"},Tl={class:"px-4 py-2 font-mono"},_l={class:"px-4 py-2"},Ll={class:"px-4 py-2 text-muted-foreground"},Bl={class:"flex justify-between items-center px-6 py-4 border-t border-border"},zl={class:"flex space-x-2"},El=["disabled"],Kl=["disabled"],Dl={__name:"ImportWizard",props:{vault:String,stage:String},emits:["imported","close"],setup(r,{emit:o}){const i=r,d=o,p=K(),m=g(1),f=g(""),y=g(""),b=g(!1),x=g({only:"",except:""}),h=g(!1),$=g({total:0,new:0,existing:0,invalid:0,empty:0,secrets:[]}),j=g("skip"),M=g(!1),V=g(!1),L=g({imported:0,skipped:0,failed:0,results:{},errors:[]}),B=e(()=>$.value.secrets||[]);function z(e){const t=e.target.files[0];t&&D(t)}function E(e){e.preventDefault(),b.value=!1;const t=e.dataTransfer.files;if(0===t.length)return;const l=t[0];l.name.match(/\.env(\.|$)/)?D(l):p.error("Invalid file","Please upload a .env file")}function D(e){f.value=e.name;const t=new FileReader;t.onload=e=>{y.value=e.target.result},t.onerror=()=>{p.error("Failed to read file","Could not read the selected file")},t.readAsText(e)}async function A(){if(y.value){h.value=!0;try{const e=await window.$api.analyzeImport({content:y.value,vault:i.vault,stage:i.stage,only:x.value.only||null,except:x.value.except||null});$.value=e.analysis,m.value=2,0===$.value.existing&&(j.value="skip")}catch(e){p.error("Failed to analyze import",e.message)}finally{h.value=!1}}else p.error("No content to import","Please upload a file or paste content")}async function U(){V.value=!0;try{const e=await window.$api.executeImport({content:y.value,vault:i.vault,stage:i.stage,strategy:j.value,only:x.value.only||null,except:x.value.except||null,dry_run:M.value});L.value=e,m.value=3,!M.value&&e.imported>0&&(p.success("Import successful",`Imported ${e.imported} secrets`),d("imported"))}catch(e){p.error("Failed to import",e.message)}finally{V.value=!1}}function O(){m.value=1,f.value="",y.value="",b.value=!1,d("close"),x.value={only:"",except:""},$.value={total:0,new:0,existing:0,invalid:0,empty:0,secrets:[]},j.value="skip",M.value=!1,L.value={imported:0,skipped:0,failed:0,results:{},errors:[]}}function P(e){switch(e){case"new":return"bg-green-500/10 text-green-500";case"existing":return"bg-yellow-500/10 text-yellow-500";case"invalid":return"bg-red-500/10 text-red-500";case"empty":return"bg-gray-500/10 text-gray-500";default:return"bg-muted text-muted-foreground"}}function I(e){switch(e){case"new":return"New";case"existing":return"Exists";case"invalid":return"Invalid";case"empty":return"Empty";default:return e}}function q(e){switch(e){case"imported":case"would_import":return"bg-green-500/10 text-green-500";case"skipped":return"bg-yellow-500/10 text-yellow-500";case"failed":return"bg-red-500/10 text-red-500";default:return"bg-muted text-muted-foreground"}}function F(e){switch(e.status){case"imported":return"Imported";case"would_import":return"Would Import";case"skipped":switch(e.reason){case"empty_value":return"Skipped (empty)";case"exists":return"Skipped (exists)";default:return"Skipped"}case"failed":switch(e.reason){case"invalid_key":return"Failed (invalid)";case"exists":return"Failed (exists)";case"vault_error":return"Failed (error)";default:return"Failed"}default:return e.status}}return(e,r)=>(l(),t("div",{class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:k(O,["self"])},[a("div",Ht,[a("div",{class:"flex items-center justify-between px-6 py-4 border-b border-border"},[r[13]||(r[13]=a("h2",{class:"text-lg font-semibold"},"Import .env File",-1)),a("button",{onClick:O,class:"p-1 rounded-md hover:bg-muted transition-colors"},[...r[12]||(r[12]=[a("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),a("div",Jt,[1===m.value?(l(),t("div",Gt,[r[20]||(r[20]=a("div",null,[a("h3",{class:"font-medium mb-2"},"Upload or Paste .env Content"),a("p",{class:"text-sm text-muted-foreground mb-4"}," Select a .env file from your computer or paste the content directly. ")],-1)),a("div",{onDrop:E,onDragover:r[1]||(r[1]=k(()=>{},["prevent"])),onDragenter:[r[2]||(r[2]=k(()=>{},["prevent"])),r[4]||(r[4]=e=>b.value=!0)],onDragleave:r[3]||(r[3]=e=>b.value=!1),class:u(["border-2 border-dashed rounded-lg p-6 text-center transition-colors",b.value?"border-primary bg-primary/5":"border-border"])},[a("input",{type:"file",ref:"fileInput",onChange:z,accept:".env,.env.*",class:"hidden"},null,544),r[14]||(r[14]=a("svg",{class:"w-12 h-12 mx-auto mb-4 text-muted-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1)),a("p",Yt,n(b.value?"Drop file here...":"Drag & drop your .env file here"),1),r[15]||(r[15]=a("p",{class:"text-xs text-muted-foreground mb-4"},"or",-1)),a("button",{onClick:r[0]||(r[0]=t=>e.$refs.fileInput.click()),class:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors text-sm font-medium"}," Browse Files "),a("p",Wt,n(f.value||"Supports .env and .env.* files"),1)],34),r[21]||(r[21]=a("div",{class:"text-center text-muted-foreground text-sm"},"— OR —",-1)),a("div",null,[r[16]||(r[16]=a("label",{class:"block text-sm font-medium mb-2"},"Paste .env Content",-1)),w(a("textarea",{"onUpdate:modelValue":r[5]||(r[5]=e=>y.value=e),class:"w-full h-48 px-3 py-2 bg-input border border-border rounded-md text-sm font-mono focus:outline-none focus:ring-2 focus:ring-ring",placeholder:"KEY1=value1\nKEY2=value2\nKEY3=value3"},null,512),[[C,y.value]])]),a("div",Xt,[r[19]||(r[19]=a("h4",{class:"text-sm font-medium"},"Filter Options (Optional)",-1)),a("div",Zt,[a("div",null,[r[17]||(r[17]=a("label",{class:"block text-xs text-muted-foreground mb-1"},"Only include keys matching",-1)),w(a("input",{"onUpdate:modelValue":r[6]||(r[6]=e=>x.value.only=e),type:"text",class:"w-full px-3 py-2 bg-input border border-border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring",placeholder:"e.g., DB_* or APP_*"},null,512),[[C,x.value.only]])]),a("div",null,[r[18]||(r[18]=a("label",{class:"block text-xs text-muted-foreground mb-1"},"Exclude keys matching",-1)),w(a("input",{"onUpdate:modelValue":r[7]||(r[7]=e=>x.value.except=e),type:"text",class:"w-full px-3 py-2 bg-input border border-border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring",placeholder:"e.g., MAIL_* or TEST_*"},null,512),[[C,x.value.except]])])])])])):2===m.value?(l(),t("div",Qt,[a("div",null,[r[26]||(r[26]=a("h3",{class:"font-medium mb-2"},"Review Import",-1)),a("div",el,[a("span",null,[a("span",tl,n($.value.new),1),r[22]||(r[22]=S(" new ",-1))]),a("span",null,[a("span",ll,n($.value.existing),1),r[23]||(r[23]=S(" existing ",-1))]),a("span",null,[a("span",al,n($.value.invalid),1),r[24]||(r[24]=S(" invalid ",-1))]),a("span",null,[a("span",sl,n($.value.empty),1),r[25]||(r[25]=S(" empty ",-1))])])]),$.value.existing>0?(l(),t("div",rl,[r[29]||(r[29]=a("h4",{class:"font-medium text-yellow-500 mb-3"},"Conflict Resolution",-1)),a("div",ol,[a("label",nl,[w(a("input",{type:"radio","onUpdate:modelValue":r[8]||(r[8]=e=>j.value=e),value:"skip",class:"text-primary focus:ring-primary"},null,512),[[T,j.value]]),r[27]||(r[27]=a("span",{class:"text-sm"},"Skip existing secrets (keep current values)",-1))]),a("label",ul,[w(a("input",{type:"radio","onUpdate:modelValue":r[9]||(r[9]=e=>j.value=e),value:"overwrite",class:"text-primary focus:ring-primary"},null,512),[[T,j.value]]),r[28]||(r[28]=a("span",{class:"text-sm"},"Overwrite existing secrets (replace with new values)",-1))])])])):s("",!0),a("div",il,[a("table",dl,[r[30]||(r[30]=a("thead",{class:"bg-muted"},[a("tr",null,[a("th",{class:"text-left px-4 py-2 font-medium"},"Key"),a("th",{class:"text-left px-4 py-2 font-medium"},"Value"),a("th",{class:"text-left px-4 py-2 font-medium"},"Status")])],-1)),a("tbody",cl,[(l(!0),t(c,null,v(B.value,e=>(l(),t("tr",{key:e.key,class:u({"opacity-50":"empty"===e.status||"invalid"===e.status})},[a("td",vl,n(e.key),1),a("td",pl,n(e.value||"(empty)"),1),a("td",ml,[a("span",{class:u(["px-2 py-1 rounded text-xs font-medium",P(e.status)])},n(I(e.status)),3),e.error?(l(),t("span",gl,n(e.error),1)):s("",!0)])],2))),128))])])]),a("div",fl,[w(a("input",{type:"checkbox","onUpdate:modelValue":r[10]||(r[10]=e=>M.value=e),id:"dry-run",class:"rounded border-border"},null,512),[[_,M.value]]),r[31]||(r[31]=a("label",{for:"dry-run",class:"text-sm"}," Dry run (preview what would be imported without making changes) ",-1))])])):3===m.value?(l(),t("div",yl,[a("div",null,[a("h3",bl,"Import "+n(M.value?"Preview":"Complete"),1),a("div",xl,[a("span",null,[a("span",hl,n(L.value.imported),1),r[32]||(r[32]=S(" imported ",-1))]),a("span",null,[a("span",kl,n(L.value.skipped),1),r[33]||(r[33]=S(" skipped ",-1))]),a("span",null,[a("span",wl,n(L.value.failed),1),r[34]||(r[34]=S(" failed ",-1))])])]),M.value?(l(),t("div",Cl,[...r[35]||(r[35]=[a("p",{class:"text-sm text-blue-500"}," This was a dry run. No secrets were actually imported. ",-1)])])):s("",!0),L.value.errors&&L.value.errors.length>0?(l(),t("div",Sl,[r[36]||(r[36]=a("h4",{class:"font-medium text-red-500 mb-2"},"Errors",-1)),a("ul",$l,[(l(!0),t(c,null,v(L.value.errors,(e,a)=>(l(),t("li",{key:a,class:"text-sm text-red-500"},n(e),1))),128))])])):s("",!0),a("div",jl,[a("table",Ml,[r[37]||(r[37]=a("thead",{class:"bg-muted"},[a("tr",null,[a("th",{class:"text-left px-4 py-2 font-medium"},"Key"),a("th",{class:"text-left px-4 py-2 font-medium"},"Status"),a("th",{class:"text-left px-4 py-2 font-medium"},"Revision")])],-1)),a("tbody",Vl,[(l(!0),t(c,null,v(L.value.results,(e,s)=>(l(),t("tr",{key:s},[a("td",Tl,n(s),1),a("td",_l,[a("span",{class:u(["px-2 py-1 rounded text-xs font-medium",q(e.status)])},n(F(e)),3)]),a("td",Ll,n(e.revision||"-"),1)]))),128))])])])])):s("",!0)]),a("div",Bl,[a("div",null,[2===m.value?(l(),t("button",{key:0,onClick:r[11]||(r[11]=e=>m.value--),class:"px-4 py-2 text-sm border border-border rounded-md hover:bg-muted transition-colors"}," Back ")):s("",!0)]),a("div",zl,[a("button",{onClick:O,class:"px-4 py-2 text-sm border border-border rounded-md hover:bg-muted transition-colors"},n(3===m.value?"Close":"Cancel"),1),1===m.value?(l(),t("button",{key:0,onClick:A,disabled:!y.value||h.value,class:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors text-sm font-medium disabled:opacity-50"},n(h.value?"Analyzing...":"Next"),9,El)):2===m.value?(l(),t("button",{key:1,onClick:U,disabled:V.value,class:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors text-sm font-medium disabled:opacity-50"},n(V.value?"Importing...":M.value?"Preview Import":"Import"),9,Kl)):s("",!0)])])])]))}},Al={class:"bg-card border border-border rounded-lg p-6 w-full max-w-md"},Ul={class:"space-y-4"},Ol={class:"grid grid-cols-3 gap-2"},Pl=["onClick"],Il={class:"font-medium"},ql={class:"text-xs opacity-75 mt-1"},Fl=["placeholder"],Nl={class:"text-xs text-muted-foreground"},Rl={class:"font-medium"},Hl={class:"font-medium"},Jl={class:"font-medium"},Gl={class:"flex justify-end space-x-3 mt-6"},Yl=["disabled"],Wl={key:0},Xl={key:1},Zl={__name:"ExportModal",props:{vault:String,stage:String,secrets:{type:Array,default:()=>[]}},emits:["close"],setup(s,{emit:r}){const o=s,i=r,d=K(),p=g(!1),m=g("env"),f=g(""),y=[{value:"env",label:".env",description:"KEY=value"},{value:"json",label:"JSON",description:'{"key": "value"}'},{value:"csv",label:"CSV",description:"Spreadsheet"}],b=e(()=>o.secrets.length),x=e(()=>{const e=(new Date).toISOString().split("T")[0];return`${o.vault}-${o.stage}-${e}.${m.value}`});async function h(){p.value=!0;try{let e="";const t=f.value||x.value;switch(m.value){case"json":const t={};o.secrets.forEach(e=>{t[e.key]=e.value}),e=JSON.stringify(t,null,2);break;case"csv":e="Key,Value,Modified\n",o.secrets.forEach(t=>{const l=$(t.key),a=$(t.value),s=$(A(t.modified));e+=`${l},${a},${s}\n`});break;default:o.secrets.forEach(t=>{e+=`${t.key}=${function(e){"string"!=typeof e&&(e=String(e||""));if(e.includes("\n")||e.includes('"')||e.includes(" "))return`"${e.replace(/"/g,'\\"')}"`;return e}(t.value)}\n`})}const l=new Blob([e],{type:"text/plain;charset=utf-8"}),a=window.URL.createObjectURL(l),s=document.createElement("a");s.href=a,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(a),d.success("Export Complete",`Secrets downloaded as ${t}`),i("close")}catch(e){d.error("Export Failed",e.message)}finally{p.value=!1}}function $(e){return"string"!=typeof e&&(e=String(e||"")),/[,"\n\r]/.test(e)?'"'+e.replace(/"/g,'""')+'"':e}return(e,r)=>(l(),t("div",{class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:r[2]||(r[2]=k(t=>e.$emit("close"),["self"]))},[a("div",Al,[r[8]||(r[8]=a("h2",{class:"text-lg font-semibold mb-4"},"Download Secrets",-1)),a("div",Ul,[a("div",null,[r[3]||(r[3]=a("label",{class:"block text-sm font-medium mb-2"},"Export Format",-1)),a("div",Ol,[(l(),t(c,null,v(y,e=>a("button",{key:e.value,onClick:t=>m.value=e.value,class:u(["p-3 border rounded-md transition-colors",m.value===e.value?"border-primary bg-primary/10 text-primary":"border-border hover:bg-muted"])},[a("div",Il,n(e.label),1),a("div",ql,n(e.description),1)],10,Pl)),64))])]),a("div",null,[r[4]||(r[4]=a("label",{class:"block text-sm font-medium mb-1"},"Filename",-1)),w(a("input",{"onUpdate:modelValue":r[0]||(r[0]=e=>f.value=e),type:"text",class:"w-full px-3 py-2 bg-input border border-border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring",placeholder:x.value},null,8,Fl),[[C,f.value]])]),a("div",Nl,[a("div",null,[r[5]||(r[5]=S("Vault: ",-1)),a("span",Rl,n(s.vault),1)]),a("div",null,[r[6]||(r[6]=S("Stage: ",-1)),a("span",Hl,n(s.stage),1)]),a("div",null,[r[7]||(r[7]=S("Secrets: ",-1)),a("span",Jl,n(b.value),1)])])]),a("div",Gl,[a("button",{type:"button",onClick:r[1]||(r[1]=t=>e.$emit("close")),class:"px-4 py-2 text-sm font-medium border border-border rounded-md hover:bg-muted transition-colors"}," Cancel "),a("button",{onClick:h,disabled:p.value,class:"px-4 py-2 text-sm font-medium bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors disabled:opacity-50"},[p.value?(l(),t("span",Xl,"Preparing...")):(l(),t("span",Wl,"Download"))],8,Yl)])])]))}},Ql={class:"relative"},ea={class:"py-1"},ta={__name:"TableActionsMenu",props:{vault:String,stage:String,secrets:{type:Array,default:()=>[]}},emits:["imported"],setup(e,{emit:o}){const n=o,u=g(!1),i=g(!1),d=g(!1);function c(){i.value=!1,n("imported")}function v(e){const t=e.target.closest("button"),l=e.target.closest(".absolute.right-0");t||l||(u.value=!1)}return h(u,e=>{e?setTimeout(()=>{document.addEventListener("click",v)},0):document.removeEventListener("click",v)}),L(()=>{document.removeEventListener("click",v)}),(o,n)=>(l(),t("div",Ql,[a("button",{onClick:n[0]||(n[0]=e=>(e.stopPropagation(),void(u.value=!u.value))),class:"p-2 rounded hover:bg-muted transition-colors",title:"Actions"},[...n[6]||(n[6]=[a("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})],-1)])]),u.value?(l(),t("div",{key:0,onClick:n[3]||(n[3]=k(()=>{},["stop"])),class:"absolute right-0 mt-2 w-48 bg-popover border border-border rounded-md shadow-lg z-20"},[a("div",ea,[a("button",{onClick:n[1]||(n[1]=e=>{i.value=!0,u.value=!1}),class:"w-full text-left px-4 py-2 text-sm hover:bg-accent transition-colors flex items-center space-x-2"},[...n[7]||(n[7]=[a("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1),a("span",null,"Import .env File",-1)])]),a("button",{onClick:n[2]||(n[2]=e=>{d.value=!0,u.value=!1}),class:"w-full text-left px-4 py-2 text-sm hover:bg-accent transition-colors flex items-center space-x-2"},[...n[8]||(n[8]=[a("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),a("span",null,"Download Secrets",-1)])])])])):s("",!0),i.value?(l(),r(Dl,{key:1,vault:e.vault,stage:e.stage,onImported:c,onClose:n[4]||(n[4]=e=>i.value=!1)},null,8,["vault","stage"])):s("",!0),d.value?(l(),r(Zl,{key:2,vault:e.vault,stage:e.stage,secrets:e.secrets,onClose:n[5]||(n[5]=e=>d.value=!1)},null,8,["vault","stage","secrets"])):s("",!0)]))}};function la(){const t=g([]),l=g([]),a=g({}),s=g(!1),r=g(null),o=e(()=>{var e,l;return(null==(e=t.value.find(e=>e.isDefault))?void 0:e.slug)||(null==(l=t.value[0])?void 0:l.slug)||"vault"}),n=e(()=>a.value.default_stage||"prod");return{vaults:t,stages:l,settings:a,loading:s,error:r,defaultVault:o,defaultStage:n,loadVaults:async function(){s.value=!0,r.value=null;try{const e=await Ce.listVaults();t.value=e.vaults}catch(e){throw r.value=e.message,e}finally{s.value=!1}},loadStages:async function(){s.value=!0,r.value=null;try{const e=await Ce.listStages();l.value=e.stages}catch(e){throw r.value=e.message,e}finally{s.value=!1}},loadSettings:async function(){s.value=!0,r.value=null;try{a.value=await Ce.getSettings()}catch(e){throw r.value=e.message,e}finally{s.value=!1}},loadAll:async function(){s.value=!0,r.value=null;try{const[e,s,r]=await Promise.all([Ce.listVaults(),Ce.listStages(),Ce.getSettings()]);t.value=e.vaults,l.value=s.stages,a.value=r}catch(e){throw r.value=e.message,e}finally{s.value=!1}},verifyVaults:async function(){s.value=!0,r.value=null;try{return await Ce.verifyVaults()}catch(e){throw r.value=e.message,e}finally{s.value=!1}}}}const aa={class:"flex items-center justify-between mb-6"},sa={class:"flex items-center"},ra={class:"flex space-x-3"},oa={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},na={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ua={class:"relative"},ia={class:"border border-border rounded-lg"},da={class:"divide-y divide-border"},ca={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},va={class:"px-6 py-4 text-sm"},pa={class:"px-6 py-4 whitespace-nowrap text-sm text-muted-foreground"},ma={class:"px-6 py-4 whitespace-nowrap text-right text-sm"},ga={key:0,class:"p-8 text-center text-muted-foreground"},fa={__name:"SecretsTable",emits:["refresh"],setup(o,{emit:d}){const m=K(),{vaults:b,stages:x,settings:k,loadAll:S}=la(),{secrets:$,loading:j,loadSecrets:M,copySecretToStage:V}=Se(),{registerSearchHandler:T,registerModalCloseHandler:_,registerMaskToggleHandler:L}=G(),B=g(localStorage.getItem("keep.secrets.vault")||""),z=g(localStorage.getItem("keep.secrets.stage")||""),E=g(""),D=g(null),U=g(!1),O=g(new Set),P=g(!1),I=g(null),q=g(null),F=g(null),N=g(null),R=g(null),H=e(()=>{if(!E.value)return $.value;const e=E.value.toLowerCase();return $.value.filter(t=>{const l=t.key.toLowerCase().includes(e),a=t.value&&t.value.toLowerCase().includes(e);return l||a})});let J=null;async function Y(){if(B.value&&z.value)try{await M(B.value,z.value,!0)}catch(e){}}function W(e){I.value=e}async function X(){oe(),await Y()}function Z(e){q.value=e}function Q(e){F.value=e}function ee(e){N.value=e}function te(e){R.value=e}function le(e){m.success("Copied to clipboard","Secret value has been copied to your clipboard")}async function ae(){R.value=null,await Y()}async function se(){q.value=null,await Y()}async function re({targetVault:e,targetStage:t}){try{await V(F.value.key,t,e,F.value.stage,F.value.vault),m.success("Secret copied",`Secret '${F.value.key}' copied to ${e}:${t}`),F.value=null}catch(l){m.error("Failed to copy secret",l.message)}}function oe(){P.value=!1,I.value=null}return f(async()=>{await async function(){try{if(await S(),!B.value){const e=k.value.default_vault;e?(B.value=e,localStorage.setItem("keep.secrets.vault",B.value)):b.value.length>0&&(B.value=b.value[0].slug||b.value[0],localStorage.setItem("keep.secrets.vault",B.value))}!z.value&&x.value.length&&(z.value=x.value[0],localStorage.setItem("keep.secrets.stage",z.value))}catch(e){}}(),await Y(),T(()=>{D.value&&D.value.focus()}),J=_(()=>{P.value=!1,I.value=null,q.value=null,F.value=null,N.value=null,R.value=null}),L(()=>{U.value=!U.value})}),y(()=>{J&&J()}),h(()=>[B.value,z.value],()=>{B.value&&localStorage.setItem("keep.secrets.vault",B.value),z.value&&localStorage.setItem("keep.secrets.stage",z.value),Y()}),(e,o)=>(l(),t("div",null,[a("div",aa,[a("div",sa,[i(fe,{vault:B.value,"onUpdate:vault":o[0]||(o[0]=e=>B.value=e),stage:z.value,"onUpdate:stage":o[1]||(o[1]=e=>z.value=e),vaults:p(b),stages:p(x)},null,8,["vault","stage","vaults","stages"])]),a("div",ra,[a("button",{onClick:o[2]||(o[2]=e=>U.value=!U.value),class:"flex items-center space-x-2 px-3 py-1.5 text-sm border border-border rounded-md hover:bg-accent transition-colors"},[U.value?(l(),t("svg",na,[...o[10]||(o[10]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])])):(l(),t("svg",oa,[...o[9]||(o[9]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])]))]),a("div",ua,[w(a("input",{ref_key:"searchInput",ref:D,"onUpdate:modelValue":o[3]||(o[3]=e=>E.value=e),type:"text",placeholder:"Search by secret key or value...",class:"w-64 px-3 py-2 bg-input border border-border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring"},null,512),[[C,E.value]]),o[11]||(o[11]=a("svg",{class:"absolute right-3 top-2.5 w-4 h-4 text-muted-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))]),a("button",{onClick:o[4]||(o[4]=e=>P.value=!0),class:"flex items-center space-x-2 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors text-sm font-medium"},[...o[12]||(o[12]=[a("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),a("span",null,"Add Secret",-1)])]),i(ta,{vault:B.value,stage:z.value,secrets:H.value,onImported:Y},null,8,["vault","stage","secrets"])])]),a("div",ia,[a("table",{class:u(["w-full",p(j)&&"opacity-50 pointer-events-none"])},[o[13]||(o[13]=a("thead",{class:"bg-muted"},[a("tr",null,[a("th",{class:"w-3/12 text-left px-6 py-3 text-xs font-medium text-muted-foreground uppercase tracking-wider rounded-tl-lg"},"Key"),a("th",{class:"w-6/12 text-left px-6 py-3 text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Value"),a("th",{class:"w-2/12 text-left px-6 py-3 text-xs font-medium text-muted-foreground uppercase tracking-wider",title:"Times shown in your local timezone"},"Modified"),a("th",{class:"relative px-6 py-3 rounded-tr-lg"},[a("span",{class:"sr-only"},"Actions")])])],-1)),a("tbody",da,[(l(!0),t(c,null,v(H.value,e=>(l(),t("tr",{key:e.key,class:"transition-colors"},[a("td",ca,n(e.key),1),a("td",va,[i(we,{value:e.value,masked:!U.value&&!O.value.has(e.key),onToggle:t=>{return l=e.key,void(O.value.has(l)?O.value.delete(l):O.value.add(l));var l}},null,8,["value","masked","onToggle"])]),a("td",pa,n(p(A)(e.modified)),1),a("td",ma,[i(Rt,{secretKey:e.key,secretValue:e.value,vault:B.value,stage:z.value,onEdit:W,onRename:Z,onCopyValue:le,onCopyTo:Q,onHistory:ee,onDelete:te,onRefresh:Y},null,8,["secretKey","secretValue","vault","stage"])])]))),128))])],2),p(j)||0!==H.value.length?s("",!0):(l(),t("div",ga," No secrets found "))]),P.value||I.value?(l(),r(Ae,{key:0,secret:I.value,vault:I.value?I.value.vault:B.value,stage:I.value?I.value.stage:z.value,onSuccess:X,onClose:oe},null,8,["secret","vault","stage"])):s("",!0),q.value?(l(),r(Je,{key:1,currentKey:q.value.key,vault:B.value,stage:z.value,onSuccess:se,onClose:o[5]||(o[5]=e=>q.value=null)},null,8,["currentKey","vault","stage"])):s("",!0),F.value?(l(),r(st,{key:2,secretKey:F.value.key,currentVault:B.value,currentStage:z.value,vaults:p(b),stages:p(x),onCopy:re,onClose:o[6]||(o[6]=e=>F.value=null)},null,8,["secretKey","currentVault","currentStage","vaults","stages"])):s("",!0),N.value?(l(),r(_t,{key:3,secretKey:N.value.key,vault:B.value,stage:z.value,onRefresh:Y,onClose:o[7]||(o[7]=e=>N.value=null)},null,8,["secretKey","vault","stage"])):s("",!0),R.value?(l(),r(qt,{key:4,secretKey:R.value.key,vault:B.value,stage:z.value,onSuccess:ae,onClose:o[8]||(o[8]=e=>R.value=null)},null,8,["secretKey","vault","stage"])):s("",!0)]))}},ya={class:"mb-6 flex justify-between"},ba={class:"flex items-center space-x-4"},xa={class:"relative"},ha={key:0,class:"absolute top-full left-0 mt-1 bg-popover border border-border rounded-md shadow-lg z-20"},ka={class:"p-2 space-y-1 max-h-96 overflow-y-auto",style:{"min-width":"max-content"}},wa=["value"],Ca={class:"text-sm"},Sa={class:"flex space-x-2"},$a={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ja={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ma={class:"relative"},Va={key:0,class:"text-center py-12"},Ta={key:1,class:"border border-border rounded-lg overflow-y-visible overflow-x-auto"},_a={class:"w-full"},La={class:"bg-muted sticky top-0 z-10"},Ba={class:"flex flex-col"},za={class:"font-semibold"},Ea={class:"text-[10px] opacity-75"},Ka={class:"divide-y divide-border"},Da={class:"sticky left-0 z-10 border-r border-border p-0"},Aa={class:"bg-background"},Ua={class:"font-mono text-sm font-medium"},Oa=["onClick","title"],Pa={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ia={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},qa={key:0,class:"flex items-center justify-between"},Fa={class:"font-mono text-sm"},Na={key:1,class:"flex items-center justify-between"},Ra={key:2,class:"text-center py-12 text-muted-foreground"},Ha={key:3,class:"text-center py-12 text-muted-foreground"},Ja={class:"bg-card border border-border rounded-lg p-6 w-full max-w-md"},Ga={class:"flex items-center justify-between mb-4"},Ya={class:"space-y-4"},Wa=["value"],Xa=["value"],Za=["value","disabled"],Qa={class:"flex justify-end space-x-2 mt-6"},es=["disabled"],ts={__name:"DiffView",setup(o){const d=K(),{vaults:m,stages:b,loadAll:x}=la(),{copySecretToStage:S}=Se(),{registerSearchHandler:$,registerModalCloseHandler:M,registerMaskToggleHandler:V}=G(),T=g([]),L=g([]),B=g(null),z=g(!1),E=g(!1),A=g(new Set),U=g(!1),O=g(null),P=g(null),I=g(null),q=g(null),F=g(null),N=g(null),R=g(null),H=g(""),J=g(null),Y=g(null),W=g(""),X=g(null),Z=e(()=>T.value.map(e=>{const[t,l]=e.split(":"),a=m.value.find(e=>(e.slug||e.name||e)===t),s=(null==a?void 0:a.name)||(null==a?void 0:a.display)||t;return{vault:t,stage:l,vaultDisplay:s}}));h(T,e=>{localStorage.setItem("keep.diff.selections",JSON.stringify(e))},{deep:!0});const Q=e(()=>{if(!B.value)return{};if(0===T.value.length)return{};const e=W.value.toLowerCase().trim(),t={};for(const[l,a]of Object.entries(B.value)){let s=!1;const r={};let o=!e||l.toLowerCase().includes(e);for(const[t,l]of Object.entries(a)){const a={};for(const[r,n]of Object.entries(l))T.value.includes(`${t}:${r}`)&&(a[r]=n,s=!0,!o&&e&&n&&(o=n.toLowerCase().includes(e)));Object.keys(a).length>0&&(r[t]=a)}s&&o&&(t[l]=r)}return t}),ee=e(()=>Object.keys(Q.value).sort((e,t)=>e.localeCompare(t)));function te(e,t=!0){const l=function(e){if(!Q.value[e])return"incomplete";const t=[];let l=Z.value.length,a=0;for(const s of Z.value){const l=re(e,s.vault,s.stage);null!=l&&(t.push(l),a++)}return a<l?"incomplete":1===new Set(t).size?"identical":"different"}(e);switch(l){case"incomplete":return"bg-red-500/10 "+(t?"hover:bg-red-500/15":"");case"identical":return"bg-green-500/10 "+(t?"hover:bg-green-500/15":"");case"different":return"bg-yellow-500/10 "+(t?"hover:bg-yellow-500/15":"");default:return"hover:bg-muted/50"}}let le=null;function ae(e){e.target.closest(".relative")||(U.value=!1),O.value&&!e.target.closest("[data-menu-key]")&&(O.value=null,P.value=null,I.value=null)}async function se(){const e=m.value.map(e=>e.slug||e.name||e),t=[...b.value];z.value=!0;try{const l=await window.$api.getDiff(t,e);B.value=l.diff||{}}catch(l){d.error("Failed to load comparison",l.message),B.value={}}finally{z.value=!1}}function re(e,t,l){return Q.value[e]&&Q.value[e][t]&&Q.value[e][t][l]||null}function oe(e,t,l){return re(e,t,l)?"":"bg-muted/30"}function ne(e,t,l){const a=re(e,t,l);return a?E.value||A.value.has(e)?a:D(a,"•"):""}function ue(e){q.value={key:e.key,vault:e.vault,stage:e.stage,value:"",isNew:!0}}function ie(e){q.value={key:e.key,vault:e.vault,stage:e.stage,value:e.value}}function de(e){N.value={key:e.key,vault:e.vault,stage:e.stage,value:e.value}}function ce(e){J.value={key:e.key,vault:e.vault,stage:e.stage}}function ve(e){Y.value={key:e.key,vault:e.vault,stage:e.stage}}function pe(e){d.success("Copied to clipboard","Secret value has been copied to your clipboard")}async function me(){await se(),Y.value=null}async function ge(){q.value=null,await se()}async function fe(){if(!R.value||!H.value)return;const[e,t]=H.value.split(":");try{await S(R.value.key,t,e,R.value.stage,R.value.vault),d.success("Secret copied",`Copied '${R.value.key}' to ${e}:${t}`),R.value=null,H.value="",await se()}catch(l){d.error("Copy failed",l.message)}}function ye(){T.value=L.value.map(e=>e.key)}function be(){T.value=[]}async function xe({targetVault:e,targetStage:t}){try{await S(N.value.key,t,e,N.value.stage,N.value.vault),d.success("Secret copied",`Secret '${N.value.key}' copied to ${e}:${t}`),N.value=null,await se()}catch(l){d.error("Failed to copy secret",l.message)}}async function he(){await se(),F.value=null}return f(()=>{document.addEventListener("click",ae),async function(){try{await x(),L.value=[];for(const e of m.value)for(const t of b.value){const l=e.slug||e.name||e;L.value.push({key:`${l}:${t}`,vault:l,vaultDisplay:e.display||e,stage:t})}const t=localStorage.getItem("keep.diff.selections");if(t)try{const e=JSON.parse(t);T.value=e.filter(e=>L.value.some(t=>t.key===e))}catch(e){T.value=L.value.map(e=>e.key)}else T.value=L.value.map(e=>e.key);await se()}catch(t){d.error("Failed to load data",t.message)}}(),$(()=>{X.value&&X.value.focus()}),le=M(()=>{q.value=null,F.value=null,R.value=null,J.value=null,Y.value=null}),V(()=>{E.value=!E.value})}),y(()=>{document.removeEventListener("click",ae),le&&le()}),(e,o)=>{var d,g,f;return l(),t("div",null,[a("div",ya,[a("div",ba,[a("div",xa,[a("button",{onClick:o[0]||(o[0]=e=>U.value=!U.value),class:"flex items-center space-x-2 px-3 py-2 bg-input border border-border rounded-md text-sm hover:bg-accent transition-colors"},[a("span",null,"Toggle Vaults / Stages ("+n(T.value.length)+"/"+n(L.value.length)+")",1),o[13]||(o[13]=a("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))]),U.value?(l(),t("div",ha,[a("div",ka,[(l(!0),t(c,null,v(L.value,e=>(l(),t("label",{key:e.key,class:"flex items-center px-2 py-1.5 hover:bg-accent rounded cursor-pointer whitespace-nowrap"},[w(a("input",{type:"checkbox",value:e.key,"onUpdate:modelValue":o[1]||(o[1]=e=>T.value=e),class:"mr-3 rounded border-border bg-input text-primary focus:ring-2 focus:ring-ring"},null,8,wa),[[_,T.value]]),a("span",Ca,[a("span",null,n(e.vaultDisplay)+" ("+n(e.vault)+")",1),o[14]||(o[14]=a("span",{class:"mx-2 text-muted-foreground"},"/",-1)),a("strong",null,n(e.stage),1)])]))),128))])])):s("",!0)]),a("div",{class:"flex items-center space-x-2 text-sm"},[a("button",{onClick:ye,class:"text-muted-foreground hover:text-foreground transition-colors"}," Select All "),o[15]||(o[15]=a("span",{class:"text-muted-foreground"},"|",-1)),a("button",{onClick:be,class:"text-muted-foreground hover:text-foreground transition-colors"}," Clear All ")])]),a("div",Sa,[a("button",{onClick:o[2]||(o[2]=e=>E.value=!E.value),class:"flex items-center space-x-2 px-3 py-2 text-sm border border-border rounded-md hover:bg-accent transition-colors"},[E.value?(l(),t("svg",ja,[...o[17]||(o[17]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])])):(l(),t("svg",$a,[...o[16]||(o[16]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])]))]),a("div",Ma,[w(a("input",{ref_key:"searchInput",ref:X,"onUpdate:modelValue":o[3]||(o[3]=e=>W.value=e),type:"text",placeholder:"Search by key or value...",class:"w-64 px-3 py-2 bg-input border border-border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring"},null,512),[[C,W.value]]),o[18]||(o[18]=a("svg",{class:"absolute right-3 top-2.5 w-4 h-4 text-muted-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))])])]),z.value?(l(),t("div",Va,[...o[19]||(o[19]=[a("div",{class:"inline-flex items-center space-x-2 text-muted-foreground"},[a("svg",{class:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),a("span",null,"Loading comparison matrix...")],-1)])])):Q.value&&Object.keys(Q.value).length>0?(l(),t("div",Ta,[a("table",_a,[a("thead",La,[a("tr",null,[o[20]||(o[20]=a("th",{class:"text-left px-4 py-3 text-xs font-medium text-muted-foreground uppercase tracking-wider sticky left-0 bg-muted z-20 min-w-[200px]"}," Secret Key ",-1)),(l(!0),t(c,null,v(Z.value,e=>(l(),t("th",{key:e,class:"px-4 py-3 text-xs font-medium text-muted-foreground uppercase tracking-wider text-center border-l border-border min-w-[80px]"},[a("div",Ba,[a("span",za,n(e.vault),1),a("span",Ea,n(e.stage),1)])]))),128))])]),a("tbody",Ka,[(l(!0),t(c,null,v(ee.value,e=>(l(),t("tr",{key:e,class:u([te(e),"transition-colors"])},[a("td",Da,[a("div",Aa,[a("div",{class:u(["px-4 py-3 flex items-center space-x-2",te(e,!1)])},[a("span",Ua,n(e),1),a("button",{onClick:t=>function(e){A.value.has(e)?A.value.delete(e):A.value.add(e)}(e),class:"p-1 rounded hover:bg-muted transition-colors",title:A.value.has(e)?"Hide values":"Show values"},[A.value.has(e)?(l(),t("svg",Ia,[...o[22]||(o[22]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])])):(l(),t("svg",Pa,[...o[21]||(o[21]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])]))],8,Oa)],2)])]),(l(!0),t(c,null,v(Z.value,s=>(l(),t("td",{key:`${e}-${s.vault}-${s.stage}`,class:u(["px-4 py-3 text-left border-l border-border relative group",oe(e,s.vault,s.stage)])},[re(e,s.vault,s.stage)?(l(),t("div",qa,[a("span",Fa,n(ne(e,s.vault,s.stage)),1),i(Rt,{secretKey:e,secretValue:re(e,s.vault,s.stage),vault:s.vault,stage:s.stage,showRename:!1,buttonClass:"opacity-0 group-hover:opacity-100",onEdit:ie,onCopyValue:pe,onCopyTo:de,onHistory:ce,onDelete:ve,onRefresh:se},null,8,["secretKey","secretValue","vault","stage"])])):(l(),t("div",Na,[o[23]||(o[23]=a("span",{class:"text-muted-foreground text-sm"},"—",-1)),i(Rt,{secretKey:e,secretValue:null,vault:s.vault,stage:s.stage,showEdit:!1,showRename:!1,showCreate:!0,showCopyValue:!1,showCopyTo:!1,showDelete:!1,showHistory:!1,buttonClass:"opacity-0 group-hover:opacity-100",onCreate:ue},null,8,["secretKey","vault","stage"])]))],2))),128))],2))),128))])])])):z.value||null===Q.value||0!==Object.keys(Q.value).length?z.value||0!==T.value.length?s("",!0):(l(),t("div",Ha,[...o[25]||(o[25]=[a("svg",{class:"mx-auto h-12 w-12 mb-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1),a("p",{class:"text-lg font-medium mb-2"},"Select Vault/Stage Combinations",-1),a("p",{class:"text-sm"},"Use the dropdown above to select at least one vault/stage combination",-1)])])):(l(),t("div",Ra,[...o[24]||(o[24]=[a("svg",{class:"mx-auto h-12 w-12 mb-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),a("p",null,"No secrets found in the selected vaults and stages",-1)])])),q.value?(l(),r(Ae,{key:4,secret:q.value.isNew?null:q.value,vault:q.value.vault,stage:q.value.stage,initialKey:q.value.isNew?q.value.key:void 0,onSuccess:ge,onClose:o[4]||(o[4]=e=>q.value=null)},null,8,["secret","vault","stage","initialKey"])):s("",!0),R.value?(l(),t("div",{key:5,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:o[8]||(o[8]=k(e=>R.value=null,["self"]))},[a("div",Ja,[a("div",Ga,[o[27]||(o[27]=a("h2",{class:"text-lg font-semibold"},"Copy Secret",-1)),a("button",{onClick:o[5]||(o[5]=e=>R.value=null),class:"p-1 rounded-md hover:bg-muted transition-colors"},[...o[26]||(o[26]=[a("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),a("div",Ya,[a("div",null,[o[28]||(o[28]=a("label",{class:"block text-sm font-medium mb-1"},"Key",-1)),a("input",{type:"text",value:null==(d=R.value)?void 0:d.key,disabled:"",class:"w-full px-3 py-2 bg-input border border-border rounded-md text-sm opacity-50"},null,8,Wa)]),a("div",null,[o[29]||(o[29]=a("label",{class:"block text-sm font-medium mb-1"},"From",-1)),a("input",{type:"text",value:`${null==(g=R.value)?void 0:g.vault} / ${null==(f=R.value)?void 0:f.stage}`,disabled:"",class:"w-full px-3 py-2 bg-input border border-border rounded-md text-sm opacity-50"},null,8,Xa)]),a("div",null,[o[31]||(o[31]=a("label",{class:"block text-sm font-medium mb-1"},"Copy To",-1)),w(a("select",{"onUpdate:modelValue":o[6]||(o[6]=e=>H.value=e),class:"w-full px-3 py-2 bg-input border border-border rounded-md text-sm"},[o[30]||(o[30]=a("option",{value:""},"Select destination...",-1)),(l(!0),t(c,null,v(L.value,e=>{var a,s;return l(),t("option",{key:e.key,value:e.key,disabled:e.key===`${null==(a=R.value)?void 0:a.vault}:${null==(s=R.value)?void 0:s.stage}`},n(e.vaultDisplay)+" / "+n(e.stage),9,Za)}),128))],512),[[j,H.value]])])]),a("div",Qa,[a("button",{onClick:o[7]||(o[7]=e=>{R.value=null,H.value=""}),class:"px-4 py-2 text-sm border border-border rounded-md hover:bg-muted transition-colors"}," Cancel "),a("button",{onClick:fe,disabled:!H.value,class:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed"}," Copy Secret ",8,es)])])])):s("",!0),F.value?(l(),r(Je,{key:6,currentKey:F.value.key,vault:F.value.vault,stage:F.value.stage,onSuccess:he,onClose:o[9]||(o[9]=e=>F.value=null)},null,8,["currentKey","vault","stage"])):s("",!0),N.value?(l(),r(st,{key:7,secretKey:N.value.key,currentVault:N.value.vault,currentStage:N.value.stage,vaults:p(m),stages:p(b),onCopy:xe,onClose:o[10]||(o[10]=e=>N.value=null)},null,8,["secretKey","currentVault","currentStage","vaults","stages"])):s("",!0),J.value?(l(),r(_t,{key:8,secretKey:J.value.key,vault:J.value.vault,stage:J.value.stage,onRefresh:se,onClose:o[11]||(o[11]=e=>J.value=null)},null,8,["secretKey","vault","stage"])):s("",!0),Y.value?(l(),r(qt,{key:9,secretKey:Y.value.key,vault:Y.value.vault,stage:Y.value.stage,onSuccess:me,onClose:o[12]||(o[12]=e=>Y.value=null)},null,8,["secretKey","vault","stage"])):s("",!0)])}}},ls={class:"bg-card border border-border rounded-lg p-6 w-full max-w-md"},as={class:"flex items-start space-x-3 mb-4"},ss={class:"flex-1"},rs={class:"text-lg font-semibold mb-2"},os={class:"text-sm text-muted-foreground"},ns={class:"flex justify-end space-x-2 mt-6"},us={__name:"DeleteConfirmationModal",props:{title:{type:String,default:"Confirm Deletion"},message:{type:String,required:!0},confirmText:{type:String,default:"Delete"}},emits:["confirm","cancel"],setup(e,{expose:o,emit:u}){const i=u,d=g(!1);function c(){i("confirm"),d.value=!1}function v(){i("cancel"),d.value=!1}return o({open:function(){d.value=!0},close:v}),(o,u)=>(l(),r(V,{to:"body"},[d.value?(l(),t("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:k(v,["self"])},[a("div",ls,[a("div",as,[u[0]||(u[0]=a("div",{class:"flex-shrink-0 w-10 h-10 rounded-full bg-destructive/10 flex items-center justify-center"},[a("svg",{class:"w-5 h-5 text-destructive",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),a("div",ss,[a("h3",rs,n(e.title),1),a("p",os,n(e.message),1)])]),a("div",ns,[a("button",{onClick:v,class:"px-4 py-2 border border-border rounded-md hover:bg-muted transition-colors text-sm font-medium"}," Cancel "),a("button",{onClick:c,class:"px-4 py-2 bg-destructive text-destructive-foreground rounded-md hover:bg-destructive/90 transition-colors text-sm font-medium"},n(e.confirmText),1)])])])):s("",!0)]))}},is={class:"flex gap-6 mx-auto max-w-5xl"},ds={class:"w-48 flex-shrink-0"},cs={class:"space-y-1"},vs=["onClick"],ps={class:"flex-1"},ms={key:0,class:"space-y-6"},gs={class:"border border-border rounded-lg p-6 space-y-4"},fs=["value"],ys={class:"border border-border rounded-lg p-4 space-y-2 text-sm"},bs={class:"flex items-center justify-between"},xs={class:"font-mono"},hs={class:"flex items-center justify-between"},ks={class:"font-mono"},ws={key:1,class:"space-y-6"},Cs={class:"space-y-3"},Ss={class:"flex items-start justify-between"},$s={class:"flex-1"},js={class:"flex items-center space-x-3 mb-2"},Ms={class:"font-medium"},Vs={key:0,class:"px-2 py-0.5 bg-primary/10 text-primary text-xs rounded-full"},Ts={class:"space-y-1 text-sm text-muted-foreground"},_s={class:"font-mono"},Ls={class:"font-mono"},Bs={key:0},zs={class:"font-mono"},Es={class:"flex items-center space-x-2"},Ks=["onClick"],Ds=["onClick"],As={class:"flex justify-between items-center pt-4"},Us=["disabled"],Os={key:2,class:"space-y-6"},Ps={class:"border border-border rounded-lg p-4"},Is={class:"space-y-2"},qs={class:"font-medium"},Fs=["onClick"],Ns={class:"flex items-center space-x-2 mt-4 pt-4 border-t border-border"},Rs=["disabled"],Hs={class:"bg-card border border-border rounded-lg p-6 w-full max-w-md"},Js={class:"text-lg font-semibold mb-4"},Gs={class:"space-y-4"},Ys=["disabled"],Ws={class:"text-xs text-muted-foreground mt-1"},Xs={key:0},Zs=["placeholder"],Qs={key:1},er=["placeholder","disabled"],tr={class:"text-xs text-muted-foreground mt-1"},lr={key:2},ar={key:3,class:"flex items-center space-x-2"},sr={class:"flex justify-end space-x-2 mt-6"},rr={class:"bg-card border border-border rounded-lg p-6 w-full max-w-2xl max-h-[80vh] overflow-y-auto"},or={class:"flex items-center justify-between mb-4"},nr={key:0,class:"space-y-4"},ur={class:"flex items-center justify-between mb-3"},ir={class:"font-medium"},dr={key:0,class:"grid grid-cols-5 gap-2 text-sm"},cr={key:0,class:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},vr={key:1,class:"w-4 h-4 text-destructive",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},pr={key:1,class:"text-sm text-destructive mt-2"},mr={key:1,class:"text-center py-8 text-muted-foreground"},gr={class:"flex justify-end mt-6"},fr={__name:"SettingsView",setup(r){const o=K(),d=[{id:"general",label:"General"},{id:"vaults",label:"Vaults"},{id:"stages",label:"Stages"}],p=g("general"),m=g({appName:"",namespace:"",defaultVault:"",templatePath:""}),y=g("1.0.0-beta"),b=g([]),x=g(!1),h=g(null),M=g({name:"",slug:"",driver:"",scope:"",isDefault:!1}),V=g(!1),T=g(!1),L=g(null),B=g(null),z=g(null),E=g([]),D=g(""),A=g(""),U=g(null),O=e(()=>"undefined"!=typeof window?window.location.origin:"");function P(e){const t=b.value.find(t=>t.slug===e);return t?`${t.name} (${t.slug})`:e}function I(e){return{secretsmanager:{name:"AWS Secrets Manager",slug:"aws-secrets"},ssm:{name:"AWS SSM Parameter Store",slug:"aws-ssm"},test:{name:"Test Vault",slug:"test"}}[e]||{name:"",slug:""}}function q(){if(!h.value&&M.value.driver){const e=I(M.value.driver);M.value.name||(M.value.name=e.name),M.value.slug||(M.value.slug=e.slug)}}async function F(){try{await window.$api.updateSettings({app_name:m.value.appName,namespace:m.value.namespace,default_vault:m.value.defaultVault,template_path:m.value.templatePath}),o.success("Settings saved","Your changes have been saved successfully")}catch(e){o.error("Failed to save settings",e.message)}}async function N(){if(B.value)try{await window.$api.deleteVault(B.value.slug),b.value=b.value.filter(e=>e.slug!==B.value.slug),o.success("Vault deleted",`Vault "${B.value.name}" has been deleted`)}catch(e){o.error("Failed to delete vault",e.message)}finally{B.value=null}}function R(){x.value=!1,h.value=null,M.value={name:"",slug:"",driver:"",scope:"",isDefault:!1}}async function H(){try{if(h.value){await window.$api.updateVault(h.value.slug,M.value);const e=b.value.findIndex(e=>e.slug===h.value.slug);-1!==e&&(b.value[e]={...M.value}),o.success("Vault updated",`Vault "${M.value.name}" has been updated`)}else await window.$api.addVault(M.value),b.value.push({...M.value}),o.success("Vault added",`Vault "${M.value.name}" has been added`);R()}catch(e){o.error("Failed to save vault",e.message)}}async function J(){V.value=!0,T.value=!0,L.value=null;try{const e=(await window.$api.verifyVaults()).results||{};L.value=e;const t=Object.entries(e).filter(([e,t])=>!t.success);0===t.length?o.success("All vaults verified","All vaults are properly configured and accessible"):o.error("Verification failed",`${t.length} vault(s) failed verification`)}catch(e){o.error("Failed to verify vaults",e.message),T.value=!1}finally{V.value=!1}}async function G(){if(D.value)if(E.value.includes(D.value))o.error("Stage exists",`Stage "${D.value}" already exists`);else try{await window.$api.addStage(D.value),E.value.push(D.value),o.success("Stage added",`Stage "${D.value}" has been added`),D.value=""}catch(e){o.error("Failed to add stage",e.message)}}async function Y(){if(A.value)try{await window.$api.removeStage(A.value);const e=E.value.indexOf(A.value);e>-1&&(E.value.splice(e,1),o.success("Stage removed",`Stage "${A.value}" has been removed`))}catch(e){o.error("Failed to remove stage",e.message)}finally{A.value=""}}return f(async()=>{await async function(){try{const e=await window.$api.getSettings();m.value.appName=e.app_name||"MyApp",m.value.namespace=e.namespace||"",m.value.defaultVault=e.default_vault||"",m.value.templatePath=e.template_path||"env",y.value=e.keep_version||"1.0.0-beta"}catch(e){o.error("Failed to load settings",e.message)}}(),await async function(){try{const e=await window.$api.listVaults();b.value=e.vaults||[]}catch(e){o.error("Failed to load vaults",e.message)}}(),await async function(){try{const e=await window.$api.listStages();E.value=e.stages||[]}catch(e){o.error("Failed to load stages",e.message)}}()}),(e,r)=>{var o;return l(),t(c,null,[a("div",is,[a("div",ds,[a("div",cs,[(l(),t(c,null,v(d,e=>a("button",{key:e.id,onClick:t=>p.value=e.id,class:u(["w-full px-4 py-2 rounded-md text-sm font-medium transition-colors text-left",p.value===e.id?"bg-muted text-foreground":"text-muted-foreground hover:text-foreground hover:bg-muted/50"])},n(e.label),11,vs)),64))])]),a("div",ps,["general"===p.value?(l(),t("div",ms,[r[27]||(r[27]=a("div",null,[a("h1",{class:"text-2xl font-semibold mb-2"},"General Settings"),a("p",{class:"text-sm text-muted-foreground"},"Configure your Keep application settings")],-1)),a("div",gs,[a("div",null,[r[14]||(r[14]=a("label",{class:"block text-sm font-medium mb-2"},"Application Name",-1)),w(a("input",{"onUpdate:modelValue":r[0]||(r[0]=e=>m.value.appName=e),type:"text",class:"w-full px-3 py-2 bg-input border border-border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring",placeholder:"MyApp"},null,512),[[C,m.value.appName]]),r[15]||(r[15]=a("p",{class:"text-xs text-muted-foreground mt-1"},"The name of your application",-1))]),a("div",null,[r[16]||(r[16]=a("label",{class:"block text-sm font-medium mb-2"},"Namespace",-1)),w(a("input",{"onUpdate:modelValue":r[1]||(r[1]=e=>m.value.namespace=e),type:"text",class:"w-full px-3 py-2 bg-input border border-border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring",placeholder:"my-app"},null,512),[[C,m.value.namespace]]),r[17]||(r[17]=a("p",{class:"text-xs text-muted-foreground mt-1"},"All secrets will be organized under this namespace",-1))]),a("div",null,[r[19]||(r[19]=a("label",{class:"block text-sm font-medium mb-2"},"Default Vault",-1)),w(a("select",{"onUpdate:modelValue":r[2]||(r[2]=e=>m.value.defaultVault=e),class:"w-full px-3 py-2 bg-input border border-border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring"},[r[18]||(r[18]=a("option",{value:""},"Select default vault...",-1)),(l(!0),t(c,null,v(b.value,e=>(l(),t("option",{key:e.slug,value:e.slug},n(e.name),9,fs))),128))],512),[[j,m.value.defaultVault]]),r[20]||(r[20]=a("p",{class:"text-xs text-muted-foreground mt-1"},"The default vault to use when none is specified",-1))]),a("div",null,[r[21]||(r[21]=a("label",{class:"block text-sm font-medium mb-2"},"Template Directory",-1)),w(a("input",{"onUpdate:modelValue":r[3]||(r[3]=e=>m.value.templatePath=e),type:"text",class:"w-full px-3 py-2 bg-input border border-border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring",placeholder:"env"},null,512),[[C,m.value.templatePath]]),r[22]||(r[22]=a("p",{class:"text-xs text-muted-foreground mt-1"},"Directory where .env template files are stored",-1))]),a("div",{class:"pt-4 flex justify-end"},[a("button",{onClick:F,class:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors text-sm font-medium"}," Save Changes ")])]),a("div",null,[r[26]||(r[26]=a("h2",{class:"text-lg font-medium mb-4"},"Server Information",-1)),a("div",ys,[a("div",bs,[r[23]||(r[23]=a("span",{class:"text-muted-foreground"},"Server URL",-1)),a("span",xs,n(O.value),1)]),a("div",hs,[r[24]||(r[24]=a("span",{class:"text-muted-foreground"},"Keep Version",-1)),a("span",ks,n(y.value),1)]),r[25]||(r[25]=a("div",{class:"flex items-center justify-between"},[a("span",{class:"text-muted-foreground"},"Authentication"),a("span",{class:"text-green-500"},"Token Active")],-1))])])])):s("",!0),"vaults"===p.value?(l(),t("div",ws,[r[33]||(r[33]=a("div",null,[a("h1",{class:"text-2xl font-semibold mb-2"},"Vault Configuration"),a("p",{class:"text-sm text-muted-foreground"},"Manage your vault connections and settings")],-1)),a("div",Cs,[(l(!0),t(c,null,v(b.value,e=>(l(),t("div",{key:e.slug,class:"border border-border rounded-lg p-4"},[a("div",Ss,[a("div",$s,[a("div",js,[a("h3",Ms,n(e.name),1),e.isDefault?(l(),t("span",Vs," Default ")):s("",!0)]),a("div",Ts,[a("p",null,[r[28]||(r[28]=S("Driver: ",-1)),a("span",_s,n(e.driver),1)]),a("p",null,[r[29]||(r[29]=S("Slug: ",-1)),a("span",Ls,n(e.slug),1)]),e.scope?(l(),t("p",Bs,[r[30]||(r[30]=S("Scope: ",-1)),a("span",zs,n(e.scope),1)])):s("",!0)])]),a("div",Es,[a("button",{onClick:t=>function(e){h.value=e,M.value={name:e.name,slug:e.slug,driver:e.driver,scope:e.scope||"",isDefault:e.isDefault||!1},x.value=!0}(e),class:"p-2 rounded-md hover:bg-muted transition-colors"},[...r[31]||(r[31]=[a("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,Ks),a("button",{onClick:t=>function(e){B.value=e,z.value.open()}(e),class:"p-2 rounded-md hover:bg-muted transition-colors text-destructive"},[...r[32]||(r[32]=[a("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Ds)])])]))),128))]),a("div",As,[a("button",{onClick:r[4]||(r[4]=e=>(h.value=null,M.value={name:"",slug:"",driver:"",scope:"",isDefault:!1},void(x.value=!0))),class:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors text-sm font-medium"}," Add New Vault "),a("button",{onClick:J,disabled:V.value,class:"px-4 py-2 border border-border rounded-md hover:bg-muted transition-colors text-sm font-medium disabled:opacity-50"},n(V.value?"Verifying...":"Verify All Vaults"),9,Us)])])):s("",!0),"stages"===p.value?(l(),t("div",Os,[r[35]||(r[35]=a("div",null,[a("h1",{class:"text-2xl font-semibold mb-2"},"Stage Configuration"),a("p",{class:"text-sm text-muted-foreground"},"Manage your deployment stages and environments")],-1)),a("div",Ps,[a("div",Is,[(l(!0),t(c,null,v(E.value,e=>(l(),t("div",{key:e,class:"flex items-center justify-between py-3 border-b border-border last:border-0"},[a("span",qs,n(e),1),a("button",{onClick:t=>function(e){A.value=e,U.value.open()}(e),class:"p-2 rounded-md hover:bg-muted transition-colors text-destructive"},[...r[34]||(r[34]=[a("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Fs)]))),128))]),a("div",Ns,[w(a("input",{"onUpdate:modelValue":r[5]||(r[5]=e=>D.value=e),onKeyup:$(G,["enter"]),type:"text",placeholder:"Enter new stage name...",class:"flex-1 px-3 py-2 bg-input border border-border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring"},null,544),[[C,D.value]]),a("button",{onClick:G,disabled:!D.value,class:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors text-sm font-medium disabled:opacity-50"}," Add Stage ",8,Rs)])]),r[36]||(r[36]=a("div",{class:"bg-muted/30 rounded-lg p-4 text-sm text-muted-foreground"},[a("p",{class:"font-medium mb-1"},"About Stages"),a("p",null,"Stages represent different deployment environments for your secrets. Common stages include development, staging, and production. System stages (local, staging, production) cannot be removed.")],-1))])):s("",!0)])]),x.value?(l(),t("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:k(R,["self"])},[a("div",Hs,[a("h2",Js,n(h.value?"Edit Vault":"Add New Vault"),1),a("div",Gs,[a("div",null,[r[38]||(r[38]=a("label",{class:"block text-sm font-medium mb-1"},"Driver",-1)),w(a("select",{"onUpdate:modelValue":r[6]||(r[6]=e=>M.value.driver=e),onChange:q,class:"w-full px-3 py-2 bg-input border border-border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring",disabled:!!h.value},[...r[37]||(r[37]=[a("option",{value:""},"Select driver...",-1),a("option",{value:"secretsmanager"},"AWS Secrets Manager",-1),a("option",{value:"ssm"},"AWS SSM Parameter Store",-1),a("option",{value:"test"},"Test Vault",-1)])],40,Ys),[[j,M.value.driver]]),a("p",Ws,n(h.value?"Driver cannot be changed after creation":"Select the backend vault type"),1)]),M.value.driver||h.value?(l(),t("div",Xs,[r[39]||(r[39]=a("label",{class:"block text-sm font-medium mb-1"},"Name",-1)),w(a("input",{"onUpdate:modelValue":r[7]||(r[7]=e=>M.value.name=e),type:"text",class:"w-full px-3 py-2 bg-input border border-border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring",placeholder:I(M.value.driver).name},null,8,Zs),[[C,M.value.name]]),r[40]||(r[40]=a("p",{class:"text-xs text-muted-foreground mt-1"},"Friendly display name for this vault",-1))])):s("",!0),M.value.driver||h.value?(l(),t("div",Qs,[r[41]||(r[41]=a("label",{class:"block text-sm font-medium mb-1"},"Slug",-1)),w(a("input",{"onUpdate:modelValue":r[8]||(r[8]=e=>M.value.slug=e),type:"text",class:"w-full px-3 py-2 bg-input border border-border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring",placeholder:I(M.value.driver).slug,disabled:!!h.value},null,8,er),[[C,M.value.slug]]),a("p",tr,n(h.value?"Slug cannot be changed after creation":"Unique identifier for this vault"),1)])):s("",!0),"ssm"===M.value.driver||"secretsmanager"===M.value.driver||h.value&&["ssm","secretsmanager"].includes(h.value.driver)?(l(),t("div",lr,[r[42]||(r[42]=a("label",{class:"block text-sm font-medium mb-1"},"Scope (optional)",-1)),w(a("input",{"onUpdate:modelValue":r[9]||(r[9]=e=>M.value.scope=e),type:"text",class:"w-full px-3 py-2 bg-input border border-border rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-ring",placeholder:"app2"},null,512),[[C,M.value.scope]]),r[43]||(r[43]=a("p",{class:"text-xs text-muted-foreground mt-1"},"Optional scope to isolate secrets within your namespace.",-1))])):s("",!0),M.value.driver||h.value?(l(),t("div",ar,[w(a("input",{"onUpdate:modelValue":r[10]||(r[10]=e=>M.value.isDefault=e),type:"checkbox",id:"vault-default",class:"rounded border-border"},null,512),[[_,M.value.isDefault]]),r[44]||(r[44]=a("label",{for:"vault-default",class:"text-sm"},"Set as default vault",-1))])):s("",!0)]),a("div",sr,[a("button",{onClick:R,class:"px-4 py-2 text-sm border border-border rounded-md hover:bg-muted transition-colors"}," Cancel "),a("button",{onClick:H,class:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors text-sm font-medium"},n(h.value?"Save Changes":"Add Vault"),1)])])])):s("",!0),T.value?(l(),t("div",{key:1,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:r[13]||(r[13]=k(e=>T.value=!1,["self"]))},[a("div",rr,[a("div",or,[r[46]||(r[46]=a("h2",{class:"text-lg font-semibold"},"Vault Verification Results",-1)),a("button",{onClick:r[11]||(r[11]=e=>T.value=!1),class:"p-1 rounded-md hover:bg-muted transition-colors"},[...r[45]||(r[45]=[a("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),L.value?(l(),t("div",nr,[(l(!0),t(c,null,v(L.value,(e,o)=>(l(),t("div",{key:o,class:"border border-border rounded-lg p-4"},[a("div",ur,[a("h3",ir,n(P(o)),1),a("span",{class:u(["px-2 py-1 rounded text-xs font-medium",e.success?"bg-green-500/10 text-green-500":"bg-destructive/10 text-destructive"])},n(e.success?"Connected":"Failed"),3)]),e.success&&e.permissions?(l(),t("div",dr,[(l(!0),t(c,null,v(e.permissions,(e,s)=>(l(),t("div",{key:s,class:"flex items-center space-x-2"},[e?(l(),t("svg",cr,[...r[47]||(r[47]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):(l(),t("svg",vr,[...r[48]||(r[48]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)])])),a("span",{class:u(e?"text-muted-foreground":"text-destructive")},n(s),3)]))),128))])):e.error?(l(),t("div",pr,n(e.error),1)):s("",!0)]))),128))])):(l(),t("div",mr,[...r[49]||(r[49]=[a("div",{class:"animate-spin h-8 w-8 border-2 border-primary border-t-transparent rounded-full mx-auto mb-4"},null,-1),S(" Verifying vaults... ",-1)])])),a("div",gr,[a("button",{onClick:r[12]||(r[12]=e=>T.value=!1),class:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors text-sm font-medium"}," Close ")])])])):s("",!0),i(us,{ref_key:"deleteStageModal",ref:U,title:"Delete Stage",message:`Are you sure you want to remove the stage '${A.value}'?`,confirmText:"Remove Stage",onConfirm:Y},null,8,["message"]),i(us,{ref_key:"deleteVaultModal",ref:z,title:"Delete Vault",message:`Are you sure you want to delete the vault '${null==(o=B.value)?void 0:o.name}'?`,confirmText:"Delete Vault",onConfirm:N},null,8,["message"])],64)}}},yr={class:"fixed inset-0 z-50 overflow-y-auto"},br={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:p-0"},xr={class:"relative inline-block w-full max-w-2xl px-6 py-5 overflow-hidden text-left align-middle transition-all transform bg-background rounded-lg shadow-xl"},hr={class:"flex items-center justify-between mb-4"},kr={class:"space-y-4"},wr=["value"],Cr={key:0,class:"bg-warning/10 border border-warning/20 rounded-md p-3"},Sr={class:"flex items-center gap-2"},$r={class:"text-sm text-muted-foreground"},jr={key:1},Mr={class:"space-y-2 max-h-48 overflow-y-auto border border-border rounded-md p-3"},Vr={key:0,class:"text-center py-4"},Tr={key:1,class:"text-center py-4 text-muted-foreground"},_r=["value"],Lr={class:"text-sm"},Br={key:2,class:"space-y-2"},zr={class:"relative"},Er={class:"bg-muted/50 rounded-md p-3 text-sm font-mono overflow-x-auto max-h-64 overflow-y-auto"},Kr={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Dr={key:1,class:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ar={key:3,class:"bg-destructive/10 border border-destructive/20 rounded-md p-3"},Ur={class:"flex items-center gap-2"},Or={class:"text-sm"},Pr={class:"flex justify-end gap-3 mt-6"},Ir=["disabled"],qr=["disabled"],Fr={__name:"CreateTemplateModal",emits:["close","created"],setup(e,{emit:r}){const o=r,{showToast:u}=K(),i=g([]),d=g([]),p=g(""),m=g([]),y=g(""),b=g(""),x=g(!1),k=g(!1),C=g(!1),S=g(!1),$=g(!1);async function M(){if(p.value)try{const e=(await window.$api.get("/api/templates")).templates||[];S.value=e.some(e=>e.stage===p.value),S.value&&(y.value="",b.value="")}catch(e){}else S.value=!1}async function V(){if(p.value){b.value="",k.value=!0;try{const e=await window.$api.post("/api/templates/generate",{stage:p.value,vaults:m.value.length>0?m.value:[]});y.value=e.content||""}catch(e){b.value=e.message||"Failed to generate template preview",y.value=""}finally{k.value=!1}}else b.value="Please select a stage"}async function T(){if(p.value&&y.value){b.value="",C.value=!0;try{const e=await window.$api.post("/api/templates/create",{stage:p.value,vaults:m.value.length>0?m.value:[]});u(`Template created: ${e.filename}`,"success"),o("created",e)}catch(e){b.value=e.message||"Failed to create template"}finally{C.value=!1}}}async function L(){try{await navigator.clipboard.writeText(y.value),$.value=!0,setTimeout(()=>{$.value=!1},2e3)}catch(e){u("Failed to copy to clipboard","error")}}return f(async()=>{await async function(){try{const e=await window.$api.getSettings();i.value=e.stages||[]}catch(e){b.value="Failed to load stages"}}(),await async function(){var e;x.value=!0;try{const t=await window.$api.get("/api/vaults");d.value=(null==(e=t.vaults)?void 0:e.map(e=>e.slug))||[]}catch(t){b.value="Failed to load vaults"}finally{x.value=!1}}()}),h(p,()=>{y.value="",b.value=""}),(e,r)=>(l(),t("div",yr,[a("div",br,[a("div",{class:"fixed inset-0 transition-opacity",onClick:r[0]||(r[0]=t=>e.$emit("close"))},[...r[5]||(r[5]=[a("div",{class:"absolute inset-0 bg-black opacity-75"},null,-1)])]),a("div",xr,[a("div",hr,[r[7]||(r[7]=a("h2",{class:"text-xl font-semibold"},"Create Template",-1)),a("button",{onClick:r[1]||(r[1]=t=>e.$emit("close")),class:"p-1 rounded hover:bg-muted transition-colors"},[...r[6]||(r[6]=[a("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),a("div",kr,[a("div",null,[r[9]||(r[9]=a("label",{class:"block text-sm font-medium mb-2"},"Stage",-1)),w(a("select",{"onUpdate:modelValue":r[2]||(r[2]=e=>p.value=e),onChange:M,class:"w-full px-3 py-2 border border-border rounded-md bg-background focus:ring-2 focus:ring-primary focus:border-transparent"},[r[8]||(r[8]=a("option",{value:""},"Select a stage",-1)),(l(!0),t(c,null,v(i.value,e=>(l(),t("option",{key:e,value:e},n(e),9,wr))),128))],544),[[j,p.value]])]),S.value?(l(),t("div",Cr,[a("div",Sr,[r[11]||(r[11]=a("svg",{class:"w-5 h-5 text-warning flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),a("div",null,[r[10]||(r[10]=a("p",{class:"text-sm font-medium"},"Template already exists",-1)),a("p",$r,n(p.value)+".env already exists. You can edit it from the templates list.",1)])])])):s("",!0),S.value?s("",!0):(l(),t("div",jr,[r[13]||(r[13]=a("label",{class:"block text-sm font-medium mb-2"},"Include Vaults",-1)),a("div",Mr,[x.value?(l(),t("div",Vr,[...r[12]||(r[12]=[a("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary mx-auto"},null,-1)])])):0===d.value.length?(l(),t("div",Tr," No vaults configured ")):(l(!0),t(c,{key:2},v(d.value,e=>(l(),t("label",{key:e,class:"flex items-center space-x-2"},[w(a("input",{type:"checkbox",value:e,"onUpdate:modelValue":r[3]||(r[3]=e=>m.value=e),class:"rounded border-border text-primary focus:ring-primary"},null,8,_r),[[_,m.value]]),a("span",Lr,n(e),1)]))),128))]),r[14]||(r[14]=a("p",{class:"text-xs text-muted-foreground mt-1"}," Select which vaults to include in the template. Leave empty to include all vaults. ",-1))])),y.value&&!S.value?(l(),t("div",Br,[r[17]||(r[17]=a("label",{class:"block text-sm font-medium"},"Preview",-1)),a("div",zr,[a("pre",Er,n(y.value),1),y.value?(l(),t("button",{key:0,onClick:L,class:"absolute top-2 right-2 p-1.5 bg-background border border-border rounded hover:bg-muted transition-colors",title:"Copy to clipboard"},[$.value?(l(),t("svg",Dr,[...r[16]||(r[16]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):(l(),t("svg",Kr,[...r[15]||(r[15]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"},null,-1)])]))])):s("",!0)])])):s("",!0),b.value?(l(),t("div",Ar,[a("div",Ur,[r[18]||(r[18]=a("svg",{class:"w-5 h-5 text-destructive flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),a("p",Or,n(b.value),1)])])):s("",!0)]),a("div",Pr,[a("button",{onClick:r[4]||(r[4]=t=>e.$emit("close")),class:"px-4 py-2 text-sm border border-border rounded-md hover:bg-muted transition-colors"}," Cancel "),p.value&&y.value&&!S.value?(l(),t("button",{key:0,onClick:V,class:"px-4 py-2 text-sm bg-muted text-foreground rounded-md hover:bg-muted/80 transition-colors"}," Refresh Preview ")):s("",!0),y.value||!p.value||S.value?s("",!0):(l(),t("button",{key:1,onClick:V,disabled:k.value,class:"px-4 py-2 text-sm bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors disabled:opacity-50"},n(k.value?"Generating...":"Generate Preview"),9,Ir)),y.value&&!S.value?(l(),t("button",{key:2,onClick:T,disabled:C.value,class:"px-4 py-2 text-sm bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors disabled:opacity-50"},n(C.value?"Creating...":"Create Template"),9,qr)):s("",!0)])])])]))}},Nr={class:"fixed inset-0 z-[60] overflow-y-auto"},Rr={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:p-0"},Hr={class:"relative inline-block w-full max-w-lg px-6 py-5 overflow-hidden text-left align-middle transition-all transform bg-background rounded-lg shadow-xl"},Jr={class:"flex items-center justify-between mb-4"},Gr={class:"mb-4"},Yr={key:0,class:"flex justify-center py-8"},Wr={key:1,class:"max-h-96 overflow-y-auto space-y-1"},Xr=["onClick"],Zr={class:"flex items-center justify-between"},Qr={class:"font-mono text-sm"},eo={class:"text-xs text-muted-foreground mt-1"},to={class:"inline-flex items-center gap-1"},lo={class:"text-xs text-muted-foreground group-hover:text-foreground"},ao={key:2,class:"text-center py-8"},so={class:"text-muted-foreground"},ro={__name:"PlaceholderSelector",props:{stage:{type:String,required:!0}},emits:["close","select"],setup(s,{emit:r}){const o=s,u=r,i=g(!0),d=g(""),p=g([]),m=e(()=>{if(!d.value)return p.value;const e=d.value.toLowerCase();return p.value.filter(t=>t.placeholder.toLowerCase().includes(e)||t.vault.toLowerCase().includes(e)||t.key.toLowerCase().includes(e))});return f(async()=>{await async function(){i.value=!0;try{const e=await window.$api.get(`/api/templates/placeholders?stage=${o.stage}`);p.value=e.placeholders||[]}catch(e){p.value=[]}finally{i.value=!1}}()}),(e,s)=>(l(),t("div",Nr,[a("div",Rr,[a("div",{class:"fixed inset-0 transition-opacity",onClick:s[0]||(s[0]=t=>e.$emit("close"))},[...s[4]||(s[4]=[a("div",{class:"absolute inset-0 bg-black opacity-50"},null,-1)])]),a("div",Hr,[a("div",Jr,[s[6]||(s[6]=a("h3",{class:"text-lg font-semibold"},"Insert Placeholder",-1)),a("button",{onClick:s[1]||(s[1]=t=>e.$emit("close")),class:"p-1 rounded hover:bg-muted transition-colors"},[...s[5]||(s[5]=[a("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),a("div",Gr,[w(a("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>d.value=e),type:"text",placeholder:"Search secrets...",class:"w-full px-3 py-2 border border-border rounded-md bg-background focus:ring-2 focus:ring-primary focus:border-transparent",onKeydown:s[3]||(s[3]=$(t=>e.$emit("close"),["escape"]))},null,544),[[C,d.value]])]),i.value?(l(),t("div",Yr,[...s[7]||(s[7]=[a("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"},null,-1)])])):m.value.length>0?(l(),t("div",Wr,[(l(!0),t(c,null,v(m.value,e=>(l(),t("button",{key:e.placeholder,onClick:t=>{return l=e.placeholder,u("select",l),void u("close");var l},class:"w-full text-left px-3 py-2 rounded hover:bg-muted transition-colors group"},[a("div",Zr,[a("div",null,[a("span",Qr,n(e.placeholder),1),a("div",eo,[a("span",to,[a("span",null,n(e.vault),1),s[8]||(s[8]=a("span",null,"•",-1)),a("span",null,n(e.key),1)])])]),a("span",lo,n(e.value),1)])],8,Xr))),128))])):(l(),t("div",ao,[s[9]||(s[9]=a("svg",{class:"w-12 h-12 mx-auto text-muted-foreground mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})],-1)),a("p",so,n(d.value?"No matching secrets found":"No secrets available"),1)])),s[10]||(s[10]=a("div",{class:"mt-4 pt-4 border-t border-border"},[a("p",{class:"text-xs text-muted-foreground"}," Select a secret to insert its placeholder at the cursor position ")],-1))])])]))}},oo={class:"fixed inset-0 z-50 overflow-y-auto"},no={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:p-0"},uo={class:"relative inline-block w-full max-w-4xl px-6 py-5 overflow-hidden text-left align-middle transition-all transform bg-background rounded-lg shadow-xl"},io={class:"flex items-center justify-between mb-4"},co={class:"text-sm text-muted-foreground"},vo={key:0,class:"flex justify-center py-12"},po={key:1,class:"space-y-4"},mo={class:"flex items-center justify-between bg-muted/50 rounded-md p-2"},go={class:"flex items-center gap-2"},fo={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-primary/10 text-primary"},yo={class:"text-xs text-muted-foreground"},bo={class:"relative"},xo={class:"absolute top-0 left-0 w-12 h-full bg-muted/50 border-r border-border rounded-l-md pointer-events-none"},ho={class:"py-3 text-right pr-2"},ko={key:0,class:"bg-muted/30 rounded-md p-3"},wo={class:"flex flex-wrap gap-2"},Co={key:1,class:"bg-destructive/10 border border-destructive/20 rounded-md p-3"},So={class:"space-y-1"},$o={key:2,class:"flex items-center gap-2 text-sm text-warning"},jo={class:"flex justify-between items-center mt-6"},Mo={class:"flex gap-2"},Vo=["disabled"],To={class:"flex gap-3"},_o=["disabled"],Lo=N({__name:"TemplateEditorModal",props:{template:{type:Object,required:!0}},emits:["close","saved"],setup(o,{emit:u}){const i=o,d=u,{showToast:p}=K(),m=g(null),y=g(!0),b=g(!1),x=g(!1),k=g(""),$=g(""),j=g({}),M=g([]),V=g([]),T=g(!1),_=e(()=>k.value!==$.value),L=e(()=>{const e=k.value.split("\n").length;return Array.from({length:e},(e,t)=>t+1)});async function B(){if(_.value){b.value=!0,V.value=[];try{await window.$api.put(`/api/templates/${encodeURIComponent(i.template.filename)}`,{content:k.value}),$.value=k.value,p("Template saved successfully","success"),d("saved")}catch(e){p("Failed to save template","error")}finally{b.value=!1}}}async function z(){x.value=!0,V.value=[];try{const e=await window.$api.post("/api/templates/validate",{content:k.value,stage:j.value.stage});if(e.valid){if(p("Template is valid","success"),e.warnings&&e.warnings.length>0){const t=e.warnings.filter(e=>"unused"===e.type).length;t>0&&p(`${t} unused secret${1!==t?"s":""} found`,"info")}}else V.value=e.errors.map(e=>`Line ${e.line}: ${e.key} - ${e.error}`),p("Template has validation errors","warning")}catch(e){p("Failed to validate template","error")}finally{x.value=!1}}function E(){_.value?p("Please save changes before testing","warning"):d("close")}function D(){T.value=!0}function A(e){const t=m.value,l=t.selectionStart,a=t.selectionEnd,s=t.value,r=s.substring(0,l)+e+s.substring(a);k.value=r,setTimeout(()=>{t.selectionStart=t.selectionEnd=l+e.length,t.focus()},0)}function U(){const e=k.value.split("\n"),t=[];let l=!1;for(const a of e){const e=a.trim();if(""!==e)if(l=!1,e.startsWith("#"))t.push(a);else if(e.includes("=")){const[l,...a]=e.split("="),s=a.join("=");t.push(`${l.trim()}=${s.trim()}`)}else t.push(a);else l||(t.push(""),l=!0)}k.value=t.join("\n").trim()+"\n",p("Template formatted","success")}function O(){const e=/\{([^:}]+):([^}]+)\}/g,t=new Set;let l;for(;null!==(l=e.exec(k.value));)t.add(l[0]);M.value=Array.from(t).sort()}return f(async()=>{await async function(){y.value=!0;try{const e=await window.$api.get(`/api/templates/${encodeURIComponent(i.template.filename)}`);j.value=e,k.value=e.content||"",$.value=e.content||"",M.value=e.placeholders||[]}catch(e){p("Failed to load template","error"),d("close")}finally{y.value=!1}}()}),h(k,O),(e,u)=>(l(),t("div",oo,[a("div",no,[a("div",{class:"fixed inset-0 transition-opacity",onClick:u[0]||(u[0]=t=>e.$emit("close"))},[...u[5]||(u[5]=[a("div",{class:"absolute inset-0 bg-black opacity-75"},null,-1)])]),a("div",uo,[a("div",io,[a("div",null,[u[6]||(u[6]=a("h2",{class:"text-xl font-semibold"},"Edit Template",-1)),a("p",co,n(o.template.filename),1)]),a("button",{onClick:u[1]||(u[1]=t=>e.$emit("close")),class:"p-1 rounded hover:bg-muted transition-colors"},[...u[7]||(u[7]=[a("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),y.value?(l(),t("div",vo,[...u[8]||(u[8]=[a("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)])])):(l(),t("div",po,[a("div",mo,[a("div",go,[a("span",fo," Stage: "+n(j.value.stage),1),a("span",yo,n(M.value.length)+" placeholder"+n(1!==M.value.length?"s":""),1)]),a("div",{class:"flex items-center gap-2"},[a("button",{onClick:D,class:"px-3 py-1 text-xs bg-background border border-border rounded hover:bg-muted transition-colors"}," Insert Placeholder "),a("button",{onClick:U,class:"px-3 py-1 text-xs bg-background border border-border rounded hover:bg-muted transition-colors"}," Format ")])]),a("div",bo,[w(a("textarea",{ref_key:"editorRef",ref:m,"onUpdate:modelValue":u[2]||(u[2]=e=>k.value=e),onInput:O,class:"w-full h-96 px-4 py-3 font-mono text-sm bg-muted/30 border border-border rounded-md focus:ring-2 focus:ring-primary focus:border-transparent resize-none",spellcheck:"false",placeholder:"# Enter your template content here...\n# Use {vault:key} syntax for placeholders"},null,544),[[C,k.value]]),a("div",xo,[a("div",ho,[(l(!0),t(c,null,v(L.value,e=>(l(),t("div",{key:e,class:"text-xs text-muted-foreground h-5"},n(e),1))),128))])])]),M.value.length>0?(l(),t("div",ko,[u[9]||(u[9]=a("h3",{class:"text-sm font-medium mb-2"},"Detected Placeholders",-1)),a("div",wo,[(l(!0),t(c,null,v(M.value,e=>(l(),t("span",{key:e,class:"inline-flex items-center px-2 py-1 text-xs font-mono bg-background border border-border rounded"},n(e),1))),128))])])):s("",!0),V.value.length>0?(l(),t("div",Co,[u[11]||(u[11]=a("h3",{class:"text-sm font-medium mb-2 text-destructive"},"Validation Errors",-1)),a("ul",So,[(l(!0),t(c,null,v(V.value,e=>(l(),t("li",{key:e,class:"text-sm text-destructive flex items-start gap-2"},[u[10]||(u[10]=a("svg",{class:"w-4 h-4 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),S(" "+n(e),1)]))),128))])])):s("",!0),_.value?(l(),t("div",$o,[...u[12]||(u[12]=[a("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),S(" Unsaved changes ",-1)])])):s("",!0)])),a("div",jo,[a("div",Mo,[a("button",{onClick:z,disabled:x.value,class:"px-4 py-2 text-sm border border-border rounded-md hover:bg-muted transition-colors disabled:opacity-50"},n(x.value?"Validating...":"Validate"),9,Vo),a("button",{onClick:E,class:"px-4 py-2 text-sm border border-border rounded-md hover:bg-muted transition-colors"}," Test ")]),a("div",To,[a("button",{onClick:u[3]||(u[3]=t=>e.$emit("close")),class:"px-4 py-2 text-sm border border-border rounded-md hover:bg-muted transition-colors"}," Cancel "),a("button",{onClick:B,disabled:b.value||!_.value,class:"px-4 py-2 text-sm bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors disabled:opacity-50"},n(b.value?"Saving...":"Save Template"),9,_o)])]),T.value?(l(),r(ro,{key:2,stage:j.value.stage,onClose:u[4]||(u[4]=e=>T.value=!1),onSelect:A},null,8,["stage"])):s("",!0)])])]))}},[["__scopeId","data-v-64f9e5a7"]]),Bo={class:"fixed inset-0 z-50 overflow-y-auto"},zo={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:p-0"},Eo={class:"relative inline-block w-full max-w-3xl px-6 py-5 overflow-hidden text-left align-middle transition-all transform bg-background rounded-lg shadow-xl"},Ko={class:"flex items-center justify-between mb-4"},Do={class:"text-sm text-muted-foreground"},Ao={class:"space-y-4 mb-6"},Uo=["value"],Oo=["value"],Po={key:0,class:"flex justify-center py-8"},Io=["disabled"],qo={key:1,class:"space-y-6"},Fo={class:"flex items-center gap-3"},No={key:0,class:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ro={key:1,class:"w-6 h-6 text-destructive",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ho={class:"font-semibold"},Jo={class:"text-sm text-muted-foreground"},Go={key:0,class:"space-y-4"},Yo={class:"font-medium text-destructive"},Wo={class:"space-y-2"},Xo={class:"flex items-start gap-2"},Zo={class:"flex-1"},Qo={class:"text-sm font-medium"},en={class:"font-mono"},tn={class:"text-sm text-muted-foreground mt-1"},ln={class:"text-xs text-muted-foreground mt-1"},an={key:1,class:"space-y-4"},sn={class:"font-medium text-warning"},rn={class:"space-y-2"},on={class:"flex items-start gap-2"},nn={class:"flex-1"},un={class:"text-sm font-medium"},dn={class:"text-sm text-muted-foreground mt-1"},cn={class:"font-mono"},vn={key:2,class:"space-y-4"},pn={class:"font-medium"},mn={class:"bg-muted/30 rounded-md p-3"},gn={class:"flex flex-wrap gap-2"},fn={key:3,class:"text-center py-4"},yn={class:"text-sm text-muted-foreground mt-1"},bn={class:"flex justify-end gap-3 mt-6"},xn={__name:"TemplateTesterModal",props:{template:{type:Object,required:!0}},emits:["close"],setup(r,{emit:o}){const i=r,{showToast:d}=K(),p=g(!1),m=g(!1),y=g(""),b=g([]),x=g({valid:!1,errors:[],warnings:[],unusedSecrets:[],placeholderCount:0}),h=e(()=>b.value.filter(e=>e!==i.template.stage));async function k(){if(y.value){p.value=!0;try{const e=await window.$api.post("/api/templates/validate",{filename:i.template.filename,stage:y.value});x.value=e,m.value=!0,e.valid?e.warnings&&e.warnings.length>0?d("Template is valid with warnings","warning"):d("Template is fully valid!","success"):d(`Found ${e.errors.length} error${1!==e.errors.length?"s":""}`,"error")}catch(e){d("Failed to validate template","error")}finally{p.value=!1}}else d("Please select a stage","warning")}function C(){m.value=!1,x.value={valid:!1,errors:[],warnings:[],unusedSecrets:[],placeholderCount:0}}return f(async()=>{y.value=i.template.stage,await async function(){try{const e=await window.$api.getSettings();b.value=e.stages||[]}catch(e){}}()}),(e,o)=>(l(),t("div",Bo,[a("div",zo,[a("div",{class:"fixed inset-0 transition-opacity",onClick:o[0]||(o[0]=t=>e.$emit("close"))},[...o[4]||(o[4]=[a("div",{class:"absolute inset-0 bg-black opacity-75"},null,-1)])]),a("div",Eo,[a("div",Ko,[a("div",null,[o[5]||(o[5]=a("h2",{class:"text-xl font-semibold"},"Test Template",-1)),a("p",Do,n(r.template.filename),1)]),a("button",{onClick:o[1]||(o[1]=t=>e.$emit("close")),class:"p-1 rounded hover:bg-muted transition-colors"},[...o[6]||(o[6]=[a("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),a("div",Ao,[a("div",null,[o[7]||(o[7]=a("label",{class:"block text-sm font-medium mb-2"},"Test Against Stage",-1)),w(a("select",{"onUpdate:modelValue":o[2]||(o[2]=e=>y.value=e),class:"w-full px-3 py-2 border border-border rounded-md bg-background focus:ring-2 focus:ring-primary focus:border-transparent"},[a("option",{value:r.template.stage},n(r.template.stage)+" (template stage)",9,Uo),(l(!0),t(c,null,v(h.value,e=>(l(),t("option",{key:e,value:e},n(e),9,Oo))),128))],512),[[j,y.value]])])]),m.value?(l(),t("div",qo,[a("div",{class:u(["rounded-lg p-4 border",x.value.valid?"bg-green-500/10 border-green-500/20":"bg-destructive/10 border-destructive/20"])},[a("div",Fo,[x.value.valid?(l(),t("svg",No,[...o[8]||(o[8]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])])):(l(),t("svg",Ro,[...o[9]||(o[9]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])])),a("div",null,[a("h3",Ho,n(x.value.valid?"Template is Valid":"Template Has Issues"),1),a("p",Jo,n(x.value.placeholderCount)+" placeholder"+n(1!==x.value.placeholderCount?"s":"")+" checked ",1)])])],2),x.value.errors&&x.value.errors.length>0?(l(),t("div",Go,[a("h3",Yo,"Errors ("+n(x.value.errors.length)+")",1),a("div",Wo,[(l(!0),t(c,null,v(x.value.errors,e=>(l(),t("div",{key:`${e.line}-${e.key}`,class:"bg-destructive/5 border border-destructive/20 rounded-md p-3"},[a("div",Xo,[o[10]||(o[10]=a("svg",{class:"w-4 h-4 mt-0.5 text-destructive flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),a("div",Zo,[a("p",Qo,[S(" Line "+n(e.line)+": ",1),a("span",en,n(e.key),1)]),a("p",tn,n(e.error),1),a("p",ln," Vault: "+n(e.vault||"Unknown"),1)])])]))),128))])])):s("",!0),x.value.warnings&&x.value.warnings.length>0?(l(),t("div",an,[a("h3",sn,"Warnings ("+n(x.value.warnings.length)+")",1),a("div",rn,[(l(!0),t(c,null,v(x.value.warnings,e=>(l(),t("div",{key:`${e.vault}-${e.key}`,class:"bg-warning/5 border border-warning/20 rounded-md p-3"},[a("div",on,[o[11]||(o[11]=a("svg",{class:"w-4 h-4 mt-0.5 text-warning flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),a("div",nn,[a("p",un,n(e.message),1),a("p",dn,[a("span",cn,n(e.vault)+":"+n(e.key),1)])])])]))),128))])])):s("",!0),x.value.unusedSecrets&&x.value.unusedSecrets.length>0?(l(),t("div",vn,[a("h3",pn,"Unused Secrets ("+n(x.value.unusedSecrets.length)+")",1),a("div",mn,[o[12]||(o[12]=a("p",{class:"text-sm text-muted-foreground mb-3"}," These secrets exist in the vaults but are not referenced in the template: ",-1)),a("div",gn,[(l(!0),t(c,null,v(x.value.unusedSecrets,e=>(l(),t("span",{key:`${e.vault}-${e.key}`,class:"inline-flex items-center px-2 py-1 text-xs font-mono bg-background border border-border rounded"},n(e.vault)+":"+n(e.key),1))),128))])])])):s("",!0),!x.value.valid||x.value.warnings&&0!==x.value.warnings.length?s("",!0):(l(),t("div",fn,[o[13]||(o[13]=a("svg",{class:"w-12 h-12 mx-auto text-green-600 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),o[14]||(o[14]=a("p",{class:"text-green-600 font-medium"},"All placeholders are valid!",-1)),a("p",yn," The template can be successfully processed for the "+n(y.value)+" stage. ",1)]))])):(l(),t("div",Po,[a("button",{onClick:k,disabled:p.value,class:"px-6 py-3 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors disabled:opacity-50"},n(p.value?"Testing...":"Run Validation Test"),9,Io)])),a("div",bn,[m.value?(l(),t("button",{key:0,onClick:C,class:"px-4 py-2 text-sm border border-border rounded-md hover:bg-muted transition-colors"}," Test Again ")):s("",!0),a("button",{onClick:o[3]||(o[3]=t=>e.$emit("close")),class:"px-4 py-2 text-sm bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors"}," Close ")])])])]))}},hn={class:"fixed inset-0 z-50 overflow-y-auto"},kn={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:p-0"},wn={class:"relative inline-block w-full max-w-4xl px-6 py-5 overflow-hidden text-left align-middle transition-all transform bg-background rounded-lg shadow-xl"},Cn={class:"flex items-center justify-between mb-4"},Sn={class:"text-sm text-muted-foreground"},$n={class:"space-y-4 mb-6"},jn={class:"grid grid-cols-2 gap-4"},Mn=["value"],Vn=["value"],Tn={key:0,class:"flex justify-center py-8"},_n=["disabled"],Ln={key:1,class:"space-y-4"},Bn={key:0,class:"bg-destructive/10 border border-destructive/20 rounded-md p-3"},zn={class:"flex items-center gap-2"},En={class:"text-sm"},Kn={class:"flex items-center justify-between mb-2"},Dn={class:"flex items-center gap-2"},An={class:"relative"},Un={class:"bg-muted/50 rounded-md p-4 text-sm font-mono overflow-x-auto max-h-96 overflow-y-auto"},On={class:"grid grid-cols-3 gap-4"},Pn={class:"bg-muted/30 rounded-md p-3 text-center"},In={class:"text-2xl font-semibold"},qn={class:"bg-muted/30 rounded-md p-3 text-center"},Fn={class:"text-2xl font-semibold text-green-600"},Nn={class:"bg-muted/30 rounded-md p-3 text-center"},Rn={class:"text-2xl font-semibold text-warning"},Hn={key:2,class:"bg-destructive/10 border border-destructive/20 rounded-md p-3"},Jn={class:"flex items-center gap-2"},Gn={class:"text-sm"},Yn={class:"flex justify-end gap-3 mt-6"},Wn={__name:"TemplateProcessorModal",props:{template:{type:Object,required:!0}},emits:["close"],setup(r,{emit:o}){const u=r,{showToast:i}=K(),d=g(!1),p=g(!1),m=g(""),y=g("skip"),b=g([]),x=g({}),h=g(""),k=g(!1),C=e(()=>b.value.filter(e=>e!==u.template.stage)),$=e(()=>{if(!x.value.output||!x.value.placeholders)return 0;let e=0;for(const t of x.value.placeholders)x.value.output.includes(t)||e++;return e}),M=e(()=>x.value.placeholders?x.value.placeholders.length-$.value:0);async function V(){if(m.value){d.value=!0,h.value="";try{const e=await window.$api.post("/api/templates/process",{filename:u.template.filename,stage:m.value,strategy:y.value});x.value=e,p.value=!0,e.validation&&!e.validation.valid?i("Template processed with validation errors","warning"):i("Template processed successfully","success")}catch(e){h.value=e.message||"Failed to process template",i("Failed to process template","error")}finally{d.value=!1}}else i("Please select a stage","warning")}function T(){p.value=!1,x.value={},h.value="",k.value=!1}async function _(){try{await navigator.clipboard.writeText(x.value.output),k.value=!0,i("Copied to clipboard","success"),setTimeout(()=>{k.value=!1},2e3)}catch(e){i("Failed to copy to clipboard","error")}}function L(){const e=new Blob([x.value.output],{type:"text/plain"}),t=URL.createObjectURL(e),l=document.createElement("a");l.href=t,l.download=`${m.value}.env`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(t),i("Downloaded .env file","success")}return f(async()=>{m.value=u.template.stage,await async function(){try{const e=await window.$api.getSettings();b.value=e.stages||[]}catch(e){}}()}),(e,o)=>{var u;return l(),t("div",hn,[a("div",kn,[a("div",{class:"fixed inset-0 transition-opacity",onClick:o[0]||(o[0]=t=>e.$emit("close"))},[...o[5]||(o[5]=[a("div",{class:"absolute inset-0 bg-black opacity-75"},null,-1)])]),a("div",wn,[a("div",Cn,[a("div",null,[o[6]||(o[6]=a("h2",{class:"text-xl font-semibold"},"Process Template",-1)),a("p",Sn,n(r.template.filename),1)]),a("button",{onClick:o[1]||(o[1]=t=>e.$emit("close")),class:"p-1 rounded hover:bg-muted transition-colors"},[...o[7]||(o[7]=[a("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),a("div",$n,[a("div",jn,[a("div",null,[o[8]||(o[8]=a("label",{class:"block text-sm font-medium mb-2"},"Stage",-1)),w(a("select",{"onUpdate:modelValue":o[2]||(o[2]=e=>m.value=e),class:"w-full px-3 py-2 border border-border rounded-md bg-background focus:ring-2 focus:ring-primary focus:border-transparent"},[a("option",{value:r.template.stage},n(r.template.stage)+" (template stage)",9,Mn),(l(!0),t(c,null,v(C.value,e=>(l(),t("option",{key:e,value:e},n(e),9,Vn))),128))],512),[[j,m.value]])]),a("div",null,[o[10]||(o[10]=a("label",{class:"block text-sm font-medium mb-2"},"Missing Secret Strategy",-1)),w(a("select",{"onUpdate:modelValue":o[3]||(o[3]=e=>y.value=e),class:"w-full px-3 py-2 border border-border rounded-md bg-background focus:ring-2 focus:ring-primary focus:border-transparent"},[...o[9]||(o[9]=[a("option",{value:"skip"},"Skip (leave placeholder)",-1),a("option",{value:"empty"},"Empty string",-1),a("option",{value:"error"},"Error",-1)])],512),[[j,y.value]])])]),o[11]||(o[11]=a("div",{class:"bg-muted/30 rounded-md p-3"},[a("p",{class:"text-sm text-muted-foreground"},[a("strong",null,"Skip:"),S(" Leaves placeholders as-is for missing secrets"),a("br"),a("strong",null,"Empty:"),S(" Replaces missing secrets with empty strings"),a("br"),a("strong",null,"Error:"),S(" Stops processing if any secret is missing ")])],-1))]),p.value?(l(),t("div",Ln,[x.value.validation.valid?s("",!0):(l(),t("div",Bn,[a("div",zn,[o[12]||(o[12]=a("svg",{class:"w-5 h-5 text-destructive flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),a("p",En," Template has "+n(x.value.validation.errorCount)+" validation error"+n(1!==x.value.validation.errorCount?"s":"")+". Output may be incomplete. ",1)])])),a("div",null,[a("div",Kn,[o[13]||(o[13]=a("label",{class:"block text-sm font-medium"},"Processed Output",-1)),a("div",Dn,[a("button",{onClick:L,class:"px-3 py-1 text-xs bg-background border border-border rounded hover:bg-muted transition-colors"}," Download .env "),a("button",{onClick:_,class:"px-3 py-1 text-xs bg-background border border-border rounded hover:bg-muted transition-colors"},n(k.value?"Copied!":"Copy"),1)])]),a("div",An,[a("pre",Un,n(x.value.output),1)])]),a("div",On,[a("div",Pn,[a("p",In,n((null==(u=x.value.placeholders)?void 0:u.length)||0),1),o[14]||(o[14]=a("p",{class:"text-xs text-muted-foreground"},"Total Placeholders",-1))]),a("div",qn,[a("p",Fn,n($.value),1),o[15]||(o[15]=a("p",{class:"text-xs text-muted-foreground"},"Processed",-1))]),a("div",Nn,[a("p",Rn,n(M.value),1),o[16]||(o[16]=a("p",{class:"text-xs text-muted-foreground"},"Skipped",-1))])])])):(l(),t("div",Tn,[a("button",{onClick:V,disabled:d.value,class:"px-6 py-3 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors disabled:opacity-50"},n(d.value?"Processing...":"Process Template"),9,_n)])),h.value?(l(),t("div",Hn,[a("div",Jn,[o[17]||(o[17]=a("svg",{class:"w-5 h-5 text-destructive flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),a("p",Gn,n(h.value),1)])])):s("",!0),a("div",Yn,[p.value?(l(),t("button",{key:0,onClick:T,class:"px-4 py-2 text-sm border border-border rounded-md hover:bg-muted transition-colors"}," Process Again ")):s("",!0),a("button",{onClick:o[4]||(o[4]=t=>e.$emit("close")),class:"px-4 py-2 text-sm bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors"}," Close ")])])])])}}},Xn={class:"space-y-6"},Zn={class:"flex justify-between items-center"},Qn={class:"bg-muted/50 rounded-lg p-4"},eu={class:"flex items-center gap-2"},tu={class:"text-sm font-mono"},lu={key:0,class:"flex justify-center py-12"},au={key:1,class:"text-center py-12 bg-muted/30 rounded-lg"},su={key:2,class:"bg-background border border-border rounded-lg overflow-hidden"},ru={class:"w-full"},ou={class:"divide-y divide-border"},nu={class:"px-4 py-3"},uu={class:"flex items-center gap-2"},iu={class:"font-mono text-sm"},du={class:"px-4 py-3"},cu={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-primary/10 text-primary"},vu={class:"px-4 py-3 text-sm text-muted-foreground"},pu={class:"px-4 py-3 text-sm text-muted-foreground"},mu={class:"px-4 py-3"},gu={class:"flex items-center justify-end gap-2"},fu=["onClick"],yu=["onClick"],bu=["onClick"],xu=["onClick"],hu=[{path:"/",redirect:"/secrets"},{path:"/secrets",name:"secrets",component:fa},{path:"/templates",name:"templates",component:{__name:"TemplatesView",setup(e){const{showToast:o}=K(),u=g(!1),i=g([]),d=g(""),p=g(!1),m=g(null),y=g(null),b=g(null);async function x(){u.value=!0;try{const e=await window.$api.get("/api/templates");i.value=e.templates||[],d.value=e.templatePath||"env"}catch(e){o("Failed to load templates","error")}finally{u.value=!1}}function h(){p.value=!1,x()}function k(){m.value=null,x()}function w(e){if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*10)/10+" "+["B","KB","MB"][t]}function C(e){if(!e)return"Unknown";const t=new Date(1e3*e),l=new Date-t;if(l<6e4)return"Just now";if(l<36e5){const e=Math.floor(l/6e4);return`${e} minute${1===e?"":"s"} ago`}if(l<864e5){const e=Math.floor(l/36e5);return`${e} hour${1===e?"":"s"} ago`}if(l<6048e5){const e=Math.floor(l/864e5);return`${e} day${1===e?"":"s"} ago`}return t.toLocaleDateString()}return f(()=>{x()}),(e,g)=>(l(),t("div",Xn,[a("div",Zn,[g[6]||(g[6]=a("div",null,[a("h1",{class:"text-2xl font-bold"},"Environment Templates"),a("p",{class:"text-muted-foreground mt-1"}," Manage .env templates for different stages ")],-1)),a("button",{onClick:g[0]||(g[0]=e=>p.value=!0),class:"flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors"},[...g[5]||(g[5]=[a("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),S(" Create Template ",-1)])])]),a("div",Qn,[a("div",eu,[g[7]||(g[7]=a("svg",{class:"w-4 h-4 text-muted-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})],-1)),g[8]||(g[8]=a("span",{class:"text-sm text-muted-foreground"},"Template Directory:",-1)),a("span",tu,n(d.value),1)])]),u.value?(l(),t("div",lu,[...g[9]||(g[9]=[a("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"},null,-1)])])):0===i.value.length?(l(),t("div",au,[...g[10]||(g[10]=[a("svg",{class:"w-12 h-12 mx-auto text-muted-foreground mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),a("p",{class:"text-muted-foreground mb-2"},"No templates found",-1),a("p",{class:"text-sm text-muted-foreground"},"Create your first template to get started",-1)])])):(l(),t("div",su,[a("table",ru,[g[16]||(g[16]=a("thead",{class:"bg-muted/50"},[a("tr",null,[a("th",{class:"px-4 py-3 text-left text-sm font-medium text-muted-foreground"},"Template"),a("th",{class:"px-4 py-3 text-left text-sm font-medium text-muted-foreground"},"Stage"),a("th",{class:"px-4 py-3 text-left text-sm font-medium text-muted-foreground"},"Size"),a("th",{class:"px-4 py-3 text-left text-sm font-medium text-muted-foreground"},"Last Modified"),a("th",{class:"px-4 py-3 text-right text-sm font-medium text-muted-foreground"},"Actions")])],-1)),a("tbody",ou,[(l(!0),t(c,null,v(i.value,e=>(l(),t("tr",{key:e.filename,class:"hover:bg-muted/30 transition-colors"},[a("td",nu,[a("div",uu,[g[11]||(g[11]=a("svg",{class:"w-4 h-4 text-muted-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),a("span",iu,n(e.filename),1)])]),a("td",du,[a("span",cu,n(e.stageDisplay||e.stage),1)]),a("td",vu,n(w(e.size)),1),a("td",pu,n(C(e.lastModified)),1),a("td",mu,[a("div",gu,[a("button",{onClick:t=>function(e){m.value=e}(e),class:"p-1.5 text-muted-foreground hover:text-foreground hover:bg-muted rounded transition-colors",title:"Edit Template"},[...g[12]||(g[12]=[a("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,fu),a("button",{onClick:t=>function(e){y.value=e}(e),class:"p-1.5 text-muted-foreground hover:text-foreground hover:bg-muted rounded transition-colors",title:"Test Template"},[...g[13]||(g[13]=[a("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])],8,yu),a("button",{onClick:t=>function(e){b.value=e}(e),class:"p-1.5 text-muted-foreground hover:text-foreground hover:bg-muted rounded transition-colors",title:"Process Template"},[...g[14]||(g[14]=[a("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)])],8,bu),a("button",{onClick:t=>async function(e){if(confirm(`Are you sure you want to delete ${e.filename}?`))try{await window.$api.delete(`/api/templates/${encodeURIComponent(e.filename)}`),o("Template deleted successfully","success"),await x()}catch(t){o("Failed to delete template","error")}}(e),class:"p-1.5 text-muted-foreground hover:text-destructive hover:bg-destructive/10 rounded transition-colors",title:"Delete Template"},[...g[15]||(g[15]=[a("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,xu)])])]))),128))])])])),p.value?(l(),r(Fr,{key:3,onClose:g[1]||(g[1]=e=>p.value=!1),onCreated:h})):s("",!0),m.value?(l(),r(Lo,{key:4,template:m.value,onClose:g[2]||(g[2]=e=>m.value=null),onSaved:k},null,8,["template"])):s("",!0),y.value?(l(),r(xn,{key:5,template:y.value,onClose:g[3]||(g[3]=e=>y.value=null)},null,8,["template"])):s("",!0),b.value?(l(),r(Wn,{key:6,template:b.value,onClose:g[4]||(g[4]=e=>b.value=null)},null,8,["template"])):s("",!0)]))}}},{path:"/diff",name:"diff",component:ts},{path:"/settings",name:"settings",component:fr}],ku=B({history:z(),routes:hu});window.$api=Ce,E(oe).use(ku).mount("#app");
//# sourceMappingURL=app.BanXBr_L.js.map
